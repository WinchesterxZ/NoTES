# Lab: User ID Controlled by Request Parameter (Unpredictable IDs)

**Objective:** Find the GUID for user `carlos`, access his account page, and submit his API key.
**Vulnerability:** Horizontal Privilege Escalation (IDOR) with Information Disclosure.
**Credentials:** `wiener:peter`

---

## 1. Reconnaissance

I logged in with the provided credentials. Upon inspecting the "My Account" page URL, I noticed that the application uses a **GUID** (Globally Unique Identifier) to identify users instead of a simple username or integer.

**URL Structure:**
```http
/my-account?id=512f45b9-c68f-432d-907b-ff...
```

![[Pasted image 20251123183025.png]]

Since GUIDs are too complex to brute-force or guess, I needed to find a place where the application leaks Carlos's ID.

## 2. Information Disclosure

I navigated to the application's **Home** page to look for content generated by other users. I found a blog post written by `carlos`.

![[Pasted image 20251123183111.png]]

I clicked on the author's name (`carlos`) or inspected the link in the HTML source. The application disclosed Carlos's GUID in the URL parameter for his profile/filter page.

**Extracted GUID:** ![[Pasted image 20251123183149.png]]

---

## 3. Exploitation

Now that I possessed the victim's identifier, I returned to the "My Account" endpoint.

I intercepted the request and replaced my GUID with the one I discovered for `carlos`.

HTTP

```
GET /my-account?id=YOUR_STOLEN_GUID_HERE HTTP/1.1
```

![[Pasted image 20251123183238.png]]

### Result

The server accepted the GUID and displayed Carlos's account page. I copied his API key and submitted it to solve the lab.

![[Pasted image 20251123183310.png]]