# Lab: User Role Controlled by Request Parameter

**Objective:** Access the admin panel at `/admin` and delete the user `carlos`.
**Vulnerability:** Privilege Escalation via Cookie Manipulation.
**Credentials:** `wiener:peter`

---

## 1. Reconnaissance

I started by performing a legitimate login using the provided credentials (`wiener:peter`).

Upon analyzing the HTTP history after login, I noticed a specific cookie parameter in the session headers. The application sets a cookie named `Admin` which controls the user's privilege level. By default, for a regular user, this is set to `false`.

**Request Analysis:**
![[Pasted image 20251123175856.png]]

---

## 2. Exploitation

To escalate privileges, I attempted to manipulate this parameter.

### Step 1: Accessing the Admin Panel
I navigated to the `/admin` endpoint. I intercepted the request using Burp Suite and modified the cookie value from `false` to `true`.

```http
Cookie: session=...; Admin=true
```

The server accepted the modified cookie and responded with a **200 OK**, granting access to the Admin Panel.

![[Pasted image 20251123175933.png]]

### Step 2: Deleting the Victim

Inside the admin panel, I located the option to delete the user `carlos`.

![[Pasted image 20251123180009.png]]

I clicked the delete button and intercepted the resulting request. Once again, I ensured the `Admin` cookie was set to `true` to authorize the action.

![[Pasted image 20251123180054.png]]

### Result

The request was processed successfully, and the user `carlos` was deleted, solving the lab.

![[Pasted image 20251123180123.png]]
