
# Real-Life Broken Access Control Scenarios

## Executive Summary
Broken Access Control (BAC) remains the #1 vulnerability in the OWASP Top 10. Unlike other vulnerabilities that can be automated (like XSS or SQLi), BAC often requires a human understanding of business logic.

This report details **3 verified, real-world scenarios** where major platforms (Shopify, GitLab.) failed to enforce permissions, leading to critical data breaches or account takeovers.

---
## Case Study 1: The "Meta" Breach - HackerOne IDOR
**Target:** HackerOne (The Platform Itself)
**Vulnerability:** Insecure Direct Object Reference (IDOR)
**Date:** Disclosed May 2024
**Report ID:** #2487889

###  Scenario Description
It is ironic when a security platform itself suffers from a simple access control flaw. A researcher discovered that the endpoint used to fetch bug report details did not properly validate if the requesting user belonged to the organization they were querying.

###  Technical Breakdown
The vulnerability existed in the `/bugs.json` endpoint. This endpoint is used by programs to retrieve a list of their vulnerabilities.

**The Malicious Request:**
```http
POST /bugs.json HTTP/2
Host: hackerone.com
Content-Type: application/x-www-form-urlencoded

text_query=1&organization_id=58579&persist=true
```

**The Exploit:**

1. The attacker captures their own request to `/bugs.json`.
    
2. They identify the `organization_id` parameter (e.g., `58579`).
    
3. They swap this ID with the ID of a private program (e.g., `1337` for a major company like Uber or Twitter).
    
4. **Result:** The server returned the sensitive bug reports (titles, severity, status) for that private program, bypassing the organization membership check.
    

###  Impact

- **Confidentiality Loss:** Leakage of zero-day vulnerabilities reported to other companies before they are fixed.
    
- **Business Logic Flaw:** Complete bypass of the "Private Program" model.
    

---

##  Case Study 2: Shopify Partner Privilege Escalation

**Target:** Shopify Partners **Vulnerability:** Privilege Escalation via Logic Flaw **Date:** Disclosed Late 2024 **Report ID:** #2885269

###  Scenario Description

Shopify allows "Partners" to invite staff members to manage stores. A critical flaw in the invitation acceptance flow allowed a low-privileged user to accept an invitation meant for a high-privileged user (like an Owner), effectively stealing their role.

###  Technical Breakdown

The vulnerability lay in the lack of **Email Verification** during the invitation acceptance process.

**The Attack Flow:**

1. **Recon:** Attacker identifies the email address of a target organization's Owner or Admin (e.g., `admin@target-shop.com`).
    
2. **Setup:** Attacker creates a Shopify Partner account using that _exact_ email address (`admin@target-shop.com`). Since email verification was missing or skippable at a specific stage, the account is created but unverified.
    
3. **The Trigger:** When the legitimate Organization sends an invite to `admin@target-shop.com`, the attacker (who "owns" that unverified account login) can see and accept the invitation.
    
4. **Escalation:** The attacker accepts the invite and is granted "Owner" permissions on the target store.
    

###  Impact

- **Account Takeover (ATO):** Full control over a merchant's store.
    
- **Financial Loss:** Ability to redirect payments, export customer data, or destroy the store.
