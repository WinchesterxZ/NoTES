# Lab: Insecure Direct Object References (IDOR)

**Objective:** Retrieve the password for the user `carlos` via the chat transcript feature and log in.
**Vulnerability:** IDOR (Insecure Direct Object Reference) / Predictable Filenames.

---

## 1. Reconnaissance

I accessed the lab and located the **Live Chat** feature on the home page. I initiated a chat session to test the functionality.

![[Pasted image 20251124174838.png]]

While the bot's responses were generic and did not provide sensitive information directly, completing the chat revealed a new option: **"View Transcript."**

![[Pasted image 20251124174935.png]]

---

## 2. Vulnerability Analysis

I clicked "View Transcript" and analyzed the URL or the downloaded file request. I noticed that the application retrieves the transcript using a simple, incremental numbering scheme.

My current transcript was identified as `2.txt`.

**Request Structure:**
```http
GET /download-transcript/2.txt HTTP/1.1
```

![[Pasted image 20251124175023.png]]

This suggests that transcripts are stored sequentially and the server does not verify if the requestor owns the file.

---

## 3. Exploitation

Suspecting that the first chat transcript (`1.txt`) might belong to the victim or an administrator, I modified the request URL.

**Payload:** I changed the filename from `2.txt` to `1.txt`.

```http
GET /download-transcript/1.txt HTTP/1.1
```
![[Pasted image 20251124175118.png]]

### Result

The server returned the content of the first transcript. Inside the text file, I found a chat log where the user `carlos` had typed his password.

I used the credentials `carlos:password_found_in_text` to log in successfully.

![[Pasted image 20251124175131.png]]