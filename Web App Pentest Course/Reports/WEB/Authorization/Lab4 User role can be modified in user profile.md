# Lab: User Role Can Be Modified in User Profile

**Objective:** Access the admin panel at `/admin` and delete the user `carlos`.
**Constraint:** Admin access requires a `roleid` of **2**.
**Credentials:** `wiener:peter`

---

## 1. Reconnaissance

I logged in with the provided credentials and navigated to the "My Account" page. I tested the "Update Email" functionality to analyze how the application handles user data.

Upon sending a request to update the email, I examined the JSON response from the server. The response revealed a hidden parameter that was not present in the input form:

```json
{
  "username": "wiener",
  "email": "new-email@normal-user.net",
  "roleid": 1
}
```

This confirms the data model includes a `roleid`, where `1` represents a standard user.

![[Pasted image 20251123181454.png]]

## 2. Exploitation

Since the application reveals the `roleid` in the response, it might be vulnerable to **Mass Assignment** (also known as Auto-Binding). This occurs when an application takes user input and blindly assigns it to internal objects without filtering.

### Payload Modification

I intercepted the "Update Email" `POST` request again using Burp Proxy. I added the `roleid` parameter to the JSON body and set it to `2` (the required ID for admin privileges).

**Modified Request Body:**

```json
{
  "email": "hacker@test.com",
  "roleid": 2
}
```

![[Pasted image 20251123181527.png]]

The server processed the request and updated my profile with the elevated privileges.

## 3. Execution

With the `roleid` successfully changed to `2`, I refreshed the page and observed that the **Admin Panel** link was now visible in the navigation bar.

![[Pasted image 20251123181552.png]]

I navigated to the admin panel and successfully deleted the user `carlos`.

![[Pasted image 20251123181604.png]]