# Lab: Method-based Access Control Can Be Circumvented

**Objective:** Exploit flawed access controls to promote the user `wiener` to an administrator.
**Vulnerability:** HTTP Verb Tampering (Method-based Access Control).
**Credentials:** `administrator:admin` (for recon), `wiener:peter` (for exploitation).

---

## 1. Reconnaissance

I began by logging in with the known administrator credentials (`administrator:admin`) to understand how the administrative "Upgrade User" functionality works.

I located the function to upgrade a user's role and intercepted the request in Burp Suite.

**Target Request:**
The action generates a request to the `/admin-roles` endpoint.

![[Pasted image 20251124180522.png]]

I captured this request to use as a template.

![[Pasted image 20251124180658.png]]

---

## 2. Vulnerability Analysis

I logged out of the admin account and logged in as the regular user (`wiener:peter`).

I attempted to replay the administrative request using my low-privileged session cookie. As expected, the application's access control mechanisms blocked the request, returning an "Unauthorized" response.

![[Pasted image 20251124180814.png]]

**The Logic Flaw:**
Some applications apply access control filters based on specific HTTP methods (e.g., `<Limit POST>`). If the filter only checks `POST` requests, we might bypass it by using a different valid HTTP method that performs the same action on the backend.

---

## 3. Exploitation

I sent the blocked request to Burp Repeater. I modified the HTTP method (Verb) to bypass the specific filter on the `POST` method.

**Payload:**
I changed the method from `POST` to `PUT` (or `GET`, depending on backend support) while keeping the parameters `username=wiener&action=upgrade`.

```http
PUT /admin-roles HTTP/1.1
...
username=wiener&action=upgrade
```

![[Pasted image 20251124180915.png]]

### Result

The backend processed the request without enforcing the administrative check, successfully promoting the user `wiener` to admin.

![[Pasted image 20251124180944.png]]