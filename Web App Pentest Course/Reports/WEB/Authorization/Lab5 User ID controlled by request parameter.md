# Lab: User ID Controlled by Request Parameter

**Objective:** Obtain the API key for the user `carlos` and submit it.
**Vulnerability:** Horizontal Privilege Escalation (IDOR).
**Credentials:** `wiener:peter`

---

## 1. Reconnaissance

I began by logging in with the known credentials (`wiener:peter`). Upon accessing the "My Account" page, I observed that the application displays the user's unique **API Key**.

![[Pasted image 20251123182059.png]]

I intercepted the traffic to analyze how the application fetches this user data. The request to load the account page uses a `GET` method with a specific parameter identifying the user:

```http
GET /my-account?id=wiener HTTP/1.1
```

![[Pasted image 20251123182306.png]]

## 2. Exploitation

The presence of the `id` parameter suggests an **Insecure Direct Object Reference (IDOR)** vulnerability. The application appears to use this parameter directly to retrieve database records without verifying if the logged-in user is authorized to view other users' data.

### Attack Vector

I sent the request to Burp Repeater and modified the `id` parameter from `wiener` to the victim's username, `carlos`.

![[Pasted image 20251123182349.png]]

### Result

The server failed to enforce access controls and returned the account page for `carlos`, revealing his API key in the response body.

I copied the key and submitted it to solve the lab.

![[Pasted image 20251123182411.png]]