# Lab: User ID Controlled by Request Parameter (Data Leakage in Redirect)

**Objective:** Obtain the API key for user `carlos` by exploiting a data leak in a redirect response.
**Vulnerability:** Broken Access Control / Information Disclosure via 302 Redirect.
**Credentials:** `wiener:peter`

---

## 1. Reconnaissance

I started by logging in with the legitimate credentials (`wiener:peter`). I navigated to the "My Account" page and intercepted the traffic to understand how the application fetches user details.

The application uses a simple `id` parameter in the URL:
```http
GET /my-account?id=wiener HTTP/1.1
```

![[Pasted image 20251123183951.png]]

## 2. Exploitation attempt

I attempted a standard IDOR attack by changing the `id` parameter from `wiener` to `carlos` in Burp Repeater.

HTTP

```
GET /my-account?id=carlos HTTP/1.1
```

![[Pasted image 20251123184030.png]]

### Analyzing the Response (The Leak)

The server responded with a **302 Found** status code, attempting to redirect me back to the login page (likely because I am not authorized to view Carlos's account).

**However**, a critical flaw exists: Even though the server tells the browser to redirect, it **still includes the sensitive HTML content** of Carlos's account page in the response body.

While a normal browser would immediately follow the redirect and hide this content, Burp Suite allows us to inspect the raw response.

![[Pasted image 20251123184100.png]]

I searched the response body for "API Key" and successfully extracted Carlos's key.

---

## 3. Resolution

I copied the leaked API key from the 302 response body and submitted it to the solution checker.

![[Pasted image 20251123184116.png]]
