# Lab: Server-side Template Injection (SSTI) with Information Disclosure

**Objective:** Exploit an SSTI vulnerability to retrieve the framework's `SECRET_KEY`.
**Vulnerability:** Server-Side Template Injection (Django).
**Credentials:** `content-manager:C0nt3ntM4n4g3r`

---

## 1. Reconnaissance

I logged in using the provided credentials (`content-manager`). I navigated to the "Edit Template" functionality, which allows users to modify the templates used for product pages. This is a prime location to test for **Server-Side Template Injection (SSTI)**.

![[Pasted image 20251204130052.png]]

---

## 2. Identification (Fingerprinting)

To determine the underlying template engine, I intentionally injected invalid syntax to trigger a verbose error message.

**Payload:**
```text
{{5/0}}
```

![[Pasted image 20251204130142.png]]

**Analysis:** The error message explicitly referenced "Django," confirming that the application is built on the **Django** Python framework.

---

## 3. Vulnerability Analysis

In Django applications, sensitive configuration settings (like database passwords, debug modes, and cryptographic keys) are stored in a `settings.py` file.

I researched the internal structure of Django settings to find the exact variable name for the framework's secret key.

![[Pasted image 20251204130252.png]]

I confirmed that the variable is named `SECRET_KEY`.

![[Pasted image 20251204130341.png]]

**The Logic Flaw:** The lab description states that the vulnerability exists "via user-supplied objects." This implies that the application passes a high-privilege object (like `settings`) directly into the template context, or allows us to traverse objects to reach it.

---

## 4. Exploitation

I constructed a payload using Django template syntax (`{{ }}`) to access the `settings` object and print the `SECRET_KEY` attribute.

**Payload:**
```
{{ settings.SECRET_KEY }}
```
I injected this payload into the template editor and saved/previewed the changes.

![[Pasted image 20251204130535.png]]

### Result

The template engine rendered the variable, exposing the secret key on the page. I submitted this key to solve the lab.

![[Pasted image 20251204130611.png]]
