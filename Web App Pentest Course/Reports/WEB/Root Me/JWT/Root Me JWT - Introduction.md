# Lab: JWT - Introduction

**Objective:** Escalate privileges from `guest` to `admin` to validate the challenge.
**Vulnerability:** JWT Authentication Bypass (None Algorithm).
**Tools:** Burp Suite / JWT Editor.

---

## 1. Reconnaissance

I accessed the login page and authenticated as a `guest` user to understand how the application handles sessions.

![[Pasted image 20251130065434.png]]

The goal is to access the administration panel, which is currently restricted.

![[Pasted image 20251130065501.png]]

---

## 2. Token Analysis

I intercepted the requests after login and observed that the application uses a **JSON Web Token (JWT)** for authentication.
I decoded the token to inspect its structure.
* **Header:** Specifies the algorithm (e.g., `HS256`).
* **Payload:** Contains the user data (`username: "guest"`).
* **Signature:** Verifies the data integrity.

![[Pasted image 20251130065630.png]]

---

## 3. Exploitation (The "None" Algorithm)

The vulnerability lies in how the backend validates the token. Some JWT libraries support a `none` algorithm, which essentially tells the server: "This token is not signed, please trust it anyway."

If the server configuration is insecure, it will accept tokens with `alg: none` and bypass the signature verification step.

### Attack Steps
1.  **Modify Payload:** I changed the `username` field from `guest` to `admin`.
2.  **Modify Header:** I changed the `alg` field to `none` (or `None` / `NONE`, depending on the library).
3.  **Remove Signature:** Since the algorithm is "none", the signature is no longer valid. I removed the signature section from the token string (leaving the trailing dot `.`).

**Modified Token Structure:**
```json
// Header
{
  "typ": "JWT",
  "alg": "none"
}
// Payload
{
  "username": "admin",
}
// Signature
(Empty)
```

![[Pasted image 20251130065757.png]]

---

## 4. Result

I sent the modified request with the forged "None" token. The server accepted the token without a signature, treated me as the `admin` user, and revealed the validation flag.

![[Pasted image 20251130065837.png]]
