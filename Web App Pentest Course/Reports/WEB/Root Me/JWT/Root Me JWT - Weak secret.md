# Lab: JWT - Weak Secret

**Objective:** Recover the server's secret key, forge an admin token, and access the restricted `/admin` section.
**Vulnerability:** Weak HMAC Secret (Susceptible to Brute-Force).
**Algorithm:** HS512 (Symmetric).

---

## 1. Reconnaissance

I started by accessing the `/hello` endpoint via a GET request. The API responded with a challenge instruction:

> "Make a GET request to /token and use the token you'll get to try to access /admin with a POST request."

![[Pasted image 20251130070306.png]]

### Enumerating the Admin Endpoint
I attempted to access `/admin` using a GET request, but received a **405 Method Not Allowed** error.

![[Pasted image 20251130070336.png]]

I inspected the response headers and found the `Allow` header, which confirmed that **POST** is the required method.

```http
Allow: OPTIONS, POST
```

I then sent a POST request to `/admin`. The server responded with an authentication requirement: `"message": "method to authenticate is: 'Authorization: Bearer YOURTOKEN'"`

![[Pasted image 20251130070920.png]]

## 2. Vulnerability Analysis

I obtained a valid token from the `/token` endpoint and used it to authenticate against `/admin`.

The server rejected my access (likely because I am a standard user) but provided a critical hint in the error message:

> "I was right, you are not able to break my super crypto! **I use HS512 so no need to have a strong secret!**"

![[Pasted image 20251130072735.png]]

**The Logic Flaw:** The developer misunderstands cryptography. Using a strong hashing algorithm like HS512 does **not** secure the token if the **Secret Key** (password) used to sign it is weak. Since HS512 is a **Symmetric** algorithm, if I can guess the secret, I can forge my own valid tokens.

## 3. Exploitation (Cracking the Secret)

Since the hint implied a weak secret, I proceeded to brute-force the JWT signature.

### Step 1: Crack the Secret

I used a cracking tool `hashcat`  against the token I obtained.

**Result:** The secret was found almost instantly. **Secret:** `lol`

![[Pasted image 20251130072721.png]]

### Step 2: Forge the Admin Token

With the secret key `lol` in hand, I used the **JWT Editor** to:

1. Change the payload (e.g., set `username` or `admin` claim to `true`).
    
2. Re-sign the token using the HS512 algorithm and the recovered secret.
    

![[Pasted image 20251130072851.png]]

## 4. Result

I sent the forged Admin Token to the `/admin` endpoint via POST. The server verified the signature (which was valid because I used the correct secret) and granted access.

**Response:**

```json
{"result": "Congrats!! Here is your flag: PleaseUseAStrongSecretNextTime\n"}
```

![[Pasted image 20251130072937.png]]