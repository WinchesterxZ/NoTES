# Root Me: API - Broken Access

**Objective:** Retrieve the administrator's secret note.
**Vulnerability:** Broken Access Control / IDOR (Insecure Direct Object Reference).
**Context:** The API has endpoints for Signup, Login, retrieving user details (`/api/user`), and adding notes (`/api/note`).

![[Pasted image 20251124132241.png]]

---

## 1. Reconnaissance

I started by creating a regular user account and logging in to understand the normal application flow.

**Signup:**
![[Pasted image 20251124132143.png]]

**Login:**
Once logged in, the application retrieves my user profile.
![[Pasted image 20251124132317.png]]

---

## 2. Vulnerability Analysis

I tested the "Retrieve User" functionality. I noticed that the frontend interface is restrictive: no matter what I try to change in the UI, it always fetches **my own** user ID.

![[Pasted image 20251124132440.png]]

However, by inspecting the network traffic, I saw the backend request structure. It requests a specific user ID.

---

## 3. Exploitation

I bypassed the frontend restrictions by manually crafting the HTTP request. I navigated directly to the API endpoint and modified the `userId` in the URL to `1` (guessing the Administrator's ID).

**Exploit Payload:**
```http
GET /api/user/1 HTTP/1.1
Host: api-broken-access.challenge01.root-me.org
```

[http://api-broken-access.challenge01.root-me.org/api/user/1](http://api-broken-access.challenge01.root-me.org/api/user/1)

### Result

The API did not verify if I was authorized to view User ID 1. It returned the administrator's profile, including the secret note with the flag.

![[Pasted image 20251124132524.png]]