
# Penetration Test Report
**Client:** [[ZeroSploit Company]]
**Date:** 2025-12-23
**Assessment Type:** Android Mobile Application Penetration Test
**Target:** AllSafe Application
**Lead Pentester:** Ahmed Emad

---

## ðŸ”’ Statement of Confidentiality

> [!danger] CONFIDENTIAL
> The contents of this document have been developed by **ZeroSploit Company**. We consider the contents of this document to be proprietary and business confidential information. This document may not be released to another vendor, business partner, or contractor without prior written consent.

---

## ðŸ“‹ Table of Contents

| Section | Title                                           |
| :------ | :---------------------------------------------- |
| **1.0** | **Executive Summary**                           |
| 1.1     | Assessment Overview                             |
| 1.2     | Key Findings                                    |
| **2.0** | **Findings Summary**                            |
| 2.1     | Severity Breakdown                              |
| 2.2     | Finding List                                    |
| **3.0** | **Technical Findings Details**                  |
| 3.1     | Hardcoded Credentials & Secrets                 |
| 3.2     | Insecure Firebase Database Configuration        |
| 3.3     | SQL Injection in Login Activity                 |
| 3.4     | Insecure Service (Unauthorized Audio Recording) |
| 3.5     | Local File Inclusion via WebView                |
| 3.6     | Privilege Escalation (Object Serialization)     |
| 3.7     | Insecure Content Provider (Data Leakage)        |
| 3.8     | Native Library Authentication Bypass            |
| 3.9     | Authentication Bypass (PIN & Root)              |
| 3.10    | Insecure Logging                                |
| 3.11    | Insecure Shared Preferences                     |
| 3.12    | Deep Link Logic Exploitation                    |
| 3.13    | Insecure Broadcast Receiver                     |
| 3.14    | Weak Cryptography & Certificate Pinning Bypass  |
| 3.15    | Screen Capture Allowed (FLAG_SECURE Missing)    |
| **4.0** | **Remediation Plan**                            |

---

## 1. Executive Summary

**ZeroSploit Company** performed a comprehensive security assessment of the **AllSafe** Android application. The objective was to identify security vulnerabilities, logical flaws, and privacy issues within the application's binary and runtime environment.

### 1.1 Assessment Overview
The assessment revealed critical and high-severity vulnerabilities across multiple security domains, including **Insecure Data Storage**, **Broken Authentication**, **Component Security** (Exported Activities/Services), and **Code Tampering** resilience.

The application relies heavily on client-side controls which were trivially bypassed using runtime instrumentation (Frida). Furthermore, sensitive credentials and user data were found stored insecurely in logs, shared preferences, and the application binary itself.

### 1.2 Key Findings
* **Hardcoded Credentials:** Administrative credentials and API keys were embedded in the APK.
* **Insecure Components:** Multiple Android components (Services, Broadcast Receivers, Providers) were exported without permissions, allowing unauthorized access.
* **Runtime Manipulation:** Authentication mechanisms (PIN, Root detection, Native checks) were easily bypassed using Frida.
* **Data Leakage:** Sensitive data is logged to Logcat and stored in cleartext XML files.

> [!summary] Key Recommendation
> The development team must prioritize moving security logic (authentication, role management) to a secure server-side environment. Additionally, all sensitive data must be encrypted at rest, and Android components must be properly secured with `exported="false"` or appropriate permissions.

---

## 2. Findings Summary

### 2.1 Severity Breakdown

| Severity | Count |
| :--- | :---: |
| ðŸ”´ **Critical** | 2 |
| ðŸŸ  **High** | 8 |
| ðŸŸ¡ **Medium** | 6 |
| âšª **Info** | 0 |
| **Total** | **16** |

### 2.2 Finding List

| ID | Severity | Finding Name |
| :--- | :--- | :--- |
| 1 | ðŸ”´ Critical | Hardcoded Credentials & Secrets |
| 2 | ðŸ”´ Critical | Insecure Firebase Database Configuration |
| 3 | ðŸŸ  High | SQL Injection in Login Activity |
| 4 | ðŸŸ  High | Insecure Service (Unauthorized Audio Recording) |
| 5 | ðŸŸ  High | Local File Inclusion via WebView |
| 6 | ðŸŸ  High | Privilege Escalation (Object Serialization) |
| 7 | ðŸŸ  High | Insecure Content Provider (Data Leakage) |
| 8 | ðŸŸ  High | Native Library Authentication Bypass |
| 9 | ðŸŸ  High | Authentication Bypass (PIN & Root) |
| 10 | ðŸŸ¡ Medium | Insecure Logging (Sensitive Data Leakage) |
| 11 | ðŸŸ¡ Medium | Insecure Shared Preferences (Cleartext Storage) |
| 12 | ðŸŸ¡ Medium | Deep Link Logic Exploitation |
| 13 | ðŸŸ¡ Medium | Insecure Broadcast Receiver |
| 14 | ðŸŸ¡ Medium | Weak Cryptography & Certificate Pinning Bypass |
| 15 | ðŸŸ¡ Medium | Screen Capture Allowed (FLAG_SECURE Missing) |

---

## 3. Technical Findings Details

### 3.1 Hardcoded Credentials & Secrets

> [!fail] Severity: Critical
> **CVSS Score:** 9.0
> **CWE:** [CWE-798](https://cwe.mitre.org/data/definitions/798.html)

#### Description
The application contains hardcoded administrative credentials within `strings.xml` and the Java source code (`HardcodedCredentials.class`). These were retrieved via static analysis.

#### Evidence
**Source Code Analysis:**
Credentials found in the `BODY` constant and resource files:
* `superadmin:supersecurepassword`
* `admin:password123`
* `https://admin:password123@dev.infosecadventures.com`

![[Pasted image 20251223181705.png]]
![[Pasted image 20251223182040.png]]

#### Remediation
* [ ] Remove all hardcoded secrets from the codebase.
* [ ] Use the Android Keystore system or dynamic retrieval from a secure backend.

---

### 3.2 Insecure Firebase Database Configuration

> [!fail] Severity: Critical
> **CVSS Score:** 9.3
> **CWE:** [CWE-200](https://cwe.mitre.org/data/definitions/200.html)

#### Description
The Firebase database URL was found in `strings.xml`. Upon accessing the `/.json` endpoint, the database returned sensitive data, indicating that read permissions are enabled for unauthenticated users.

#### Evidence
**Firebase URL Discovery:**
![[Pasted image 20251223182425.png]]

**Data Exfiltration:**
Accessing the JSON endpoint revealed secrets.
![[Pasted image 20251223182548.png]]

#### Remediation
* [ ] Configure Firebase Security Rules to deny public read/write access (`".read": "auth != null"`).

---

### 3.3 SQL Injection in Login Activity

> [!fail] Severity: High
> **CVSS Score:** 8.8
> **CWE:** [CWE-89](https://cwe.mitre.org/data/definitions/89.html)

#### Description
The login function is vulnerable to SQL Injection. The application constructs SQL queries using direct string concatenation of user input.

#### Evidence
**Payload Used:**
```sql
' or 1=1-- -
```

**Result:**
Authentication was bypassed, and all user data was returned.
![[Pasted image 20251223183113.png]]

#### Remediation
* [ ] Use `SQLiteStatement` or parameterized queries (Prepared Statements) for all database interactions.

---

### 3.4 Insecure Service (Unauthorized Audio Recording)

> [!fail] Severity: High
> **CVSS Score:** 8.2
> **CWE:** [CWE-926](https://cwe.mitre.org/data/definitions/926.html)

#### Description
The `RecorderService` is exported in the AndroidManifest without any permission checks. This allows any third-party malicious app or ADB shell to start the service, which immediately begins recording audio to the SD card.

#### Evidence
**Manifest Analysis:**
Service is exported.
![[Pasted image 20251223194247.png]]

**Exploitation:**
```bash
adb shell am startservice infosecadventures.allsafe/.challenges.RecorderService
```
The service started and saved recordings to `/sdcard/Download`.
![[Pasted image 20251223194336.png]]

#### Remediation
* [ ] Set `android:exported="false"` in the Manifest.
* [ ] Implement signature-level permissions if external access is required.

---

### 3.5 Local File Inclusion via WebView

> [!fail] Severity: High
> **CVSS Score:** 8.0
> **CWE:** [CWE-200](https://cwe.mitre.org/data/definitions/200.html)

#### Description
The application contains a WebView that allows the `file://` scheme. An attacker can use this to read local files from the device file system.

#### Evidence
**Payload:**
`file:///etc/hosts`

**Result:**
The contents of `/etc/hosts` were displayed in the WebView.
![[Pasted image 20251223191837.png]]

#### Remediation
* [ ] Disable file access in WebView settings: `setAllowFileAccess(false)`.

---

### 3.6 Privilege Escalation (Object Serialization)

> [!fail] Severity: High
> **CVSS Score:** 8.1
> **CWE:** [CWE-502](https://cwe.mitre.org/data/definitions/502.html)

#### Description
User roles are stored within a serialized Java object. The application relies on client-side creation of this object. By hooking the constructor, the assessor forced the role to `ROLE_EDITOR`.

#### Evidence
**Frida Script:**
```javascript
Java.perform(function () {
    var User = Java.use("infosecadventures.allsafe.challenges.ObjectSerialization$User");
    User.$init.overload('java.lang.String', 'java.lang.String').implementation = function (user, pass) {
        this.$init(user, pass);
        this.role.value = "ROLE_EDITOR"; // Privilege Escalation
    };
});
```
**Result:**
Access granted with Editor privileges.
![[Pasted image 20251223200705.png]]

#### Remediation
* [ ] Do not trust client-side serialized objects for privilege management. Manage sessions server-side.

---

### 3.7 Insecure Content Provider (Data Leakage)

> [!fail] Severity: High
> **CVSS Score:** 7.5
> **CWE:** [CWE-926](https://cwe.mitre.org/data/definitions/926.html)

#### Description
The application exposes a Content Provider (`.dataprovider`) that allows access to local notes and files without authentication.

#### Evidence
**Drozer Query:**
`run app.provider.query content://infosecadventures.allsafe.dataprovider/notes`

**File Access:**
Read sensitive file `readme.txt` via the provider context.
![[Pasted image 20251223202748.png]]

#### Remediation
* [ ] Set `android:exported="false"` or implement `android:readPermission` / `android:writePermission`.

---

### 3.8 Native Library Authentication Bypass

> [!fail] Severity: High
> **CVSS Score:** 7.8
> **CWE:** [CWE-287](https://cwe.mitre.org/data/definitions/287.html)

#### Description
Authentication logic located in a native C/C++ library (`checkPassword`) was hooked using Frida to bypass the password check.

#### Evidence
**Frida Hook:**
```javascript
NativeLibrary.checkPassword.implementation = function (pwd) {
    return true; // Bypass
};
```
![[Pasted image 20251223203453.png]]

#### Remediation
* [ ] Implement anti-tampering/RASP checks.
* [ ] Perform authentication checks on the server side.

---

### 3.9 Authentication Bypass (PIN & Root)

> [!fail] Severity: High
> **CVSS Score:** 7.5
> **CWE:** [CWE-306](https://cwe.mitre.org/data/definitions/306.html)

#### Description
The application utilizes client-side checks for PIN verification (`PinBypass`) and Root detection (`RootBeer`). Both were trivially bypassed using Frida hooking to modify the boolean return values.

#### Evidence
**PIN Bypass Script:**
Forced `checkPin` to return `true`.
![[Pasted image 20251223184430.png]]

**Root Bypass Script:**
Forced `isRooted` to return `false`.
![[Pasted image 20251223185245.png]]

#### Remediation
* [ ] Use the Android KeyStore for PIN/Biometric authentication.
* [ ] Utilize Play Integrity API for environment attestation (though client-side checks remain inherently bypassable).

---

### 3.10 Insecure Logging

> [!warning] Severity: Medium
> **CVSS Score:** 5.3
> **CWE:** [CWE-532](https://cwe.mitre.org/data/definitions/532.html)

#### Description
The application logs sensitive user input (text entered into fields) to the system Logcat. This data is accessible to any application with the `READ_LOGS` permission (on older Android) or via physical access.

#### Evidence
**ADB Logcat:**
User input visible in logs.
![[Pasted image 20251223181407.png]]

#### Remediation
* [ ] Remove `Log` calls in production builds using ProGuard/R8 configurations (`-assumenosideeffects`).

---

### 3.11 Insecure Shared Preferences

> [!warning] Severity: Medium
> **CVSS Score:** 4.5
> **CWE:** [CWE-312](https://cwe.mitre.org/data/definitions/312.html)

#### Description
Sensitive user data is stored in cleartext XML files within the application's private directory (`/data/data/infosecadventures.allsafe/shared_prefs/user.xml`). While sandboxed, this data is vulnerable on rooted devices or via backup extraction.

#### Evidence
![[Pasted image 20251223182930.png]]

#### Remediation
* [ ] Use `EncryptedSharedPreferences` to encrypt keys and values.

---

### 3.12 Deep Link Logic Exploitation

> [!warning] Severity: Medium
> **CVSS Score:** 5.0
> **CWE:** [CWE-20](https://cwe.mitre.org/data/definitions/20.html)

#### Description
An exported activity accepts Deep Links with a `key` parameter. By reversing the code to find the correct key, the assessor could trigger protected actions.

#### Evidence
**Command:**
```bash
adb shell am start -a "android.intent.action.VIEW" -d "allsafe://infosecadventures/congrats?key=ebfb7ff0..."
```
![[Pasted image 20251223190257.png]]

#### Remediation
* [ ] Validate the caller identity and ensure deep links do not perform sensitive actions without further authentication.

---

### 3.13 Insecure Broadcast Receiver

> [!warning] Severity: Medium
> **CVSS Score:** 4.5
> **CWE:** [CWE-926](https://cwe.mitre.org/data/definitions/926.html)

#### Description
The `NoteReceiver` is exported and accepts arbitrary intents to display notifications. This can be used for phishing attacks (spoofing notifications from the trusted app).

#### Evidence
**Command:**
```bash
adb shell am broadcast ... --es notification_message "Critical: System Vulnerability Detected!"
```
![[Pasted image 20251223191713.png]]

#### Remediation
* [ ] Set `android:exported="false"` for the Receiver.

---

### 3.14 Weak Cryptography & Certificate Pinning Bypass

> [!warning] Severity: Medium
> **CVSS Score:** 5.0
> **CWE:** [CWE-327](https://cwe.mitre.org/data/definitions/327.html)

#### Description
The application's encryption implementation and SSL Certificate Pinning were analyzed and bypassed using Frida. The assessor hooked cryptographic functions to view keys and plain text inputs/outputs.

#### Evidence
**Crypto Hooking:**
Intercepted inputs to `WeakCrypto.encrypt` and `md5Hash`.
![[Pasted image 20251223195130.png]]

**Pinning Bypass:**
Used `frida-multiple-unpinning` to intercept traffic in Burp Suite.
![[Pasted image 20251223192424.png]]

#### Remediation
* [ ] While client-side pinning is bypassable, adding obfuscation and RASP increases the difficulty for attackers.

---

### 3.15 Screen Capture Allowed (FLAG_SECURE Missing)

> [!warning] Severity: Medium
> **CVSS Score:** 4.0
> **CWE:** [CWE-200](https://cwe.mitre.org/data/definitions/200.html)

#### Description
The application allows screenshots to be taken in sensitive areas of the application ("Secure Flag Bypass" challenge). This indicates the absence of `WindowManager.LayoutParams.FLAG_SECURE`.

#### Evidence
The goal of the challenge was to take a screenshot, which was successful.
![[Pasted image 20251223203917.png]]

#### Remediation
* [ ] Apply `FLAG_SECURE` to windows displaying sensitive information to prevent screenshots and screen recording.

---

## 4. Remediation Plan

### Short Term
* **Credentials:** Revoke all hardcoded credentials and API keys found in the APK immediately.
* **Exports:** Review `AndroidManifest.xml` and set `android:exported="false"` for all Services, Receivers, and Providers that do not require external access.
* **Database:** Enable strict Firebase Security Rules.

### Medium Term
* **Storage:** Migrate `SharedPreferences` to `EncryptedSharedPreferences`.
* **Input Validation:** Implement parameterized queries for SQLite.

### Long Term
* **Architecture:** Move sensitive logic (Role assignment, PIN checks, Password verification) to a backend API. Do not rely on client-side boolean checks.