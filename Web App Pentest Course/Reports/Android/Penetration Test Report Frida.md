
# Penetration Test Report
**Client:** [[Android Frida Challenges]]
**Date:** 2025-12-19
**Assessment Type:** Mobile Application Penetration Test (Runtime Manipulation)

---

## ðŸ”’ Statement of Confidentiality

> [!danger] CONFIDENTIAL
> The contents of this document have been developed by **[Your Company Name]**. We consider the contents of this document to be proprietary and business confidential information. This document may not be released to another vendor, business partner, or contractor without prior written consent.

---

## 1. Executive Summary

**Android Frida Challenges** contracted **[Your Company]** to perform a targeted security assessment of two Android application challenges (Frida 0x6 and 0x7). The objective was to evaluate the resilience of the application logic against reverse engineering and runtime instrumentation attacks.

### 1.1 Assessment Overview
The assessment focused on **Client-Side Logic flaws**. By combining static analysis (using Jadx) with dynamic instrumentation (using Frida), the assessor was able to trivially bypass authentication checks and invoke hidden functionality in both challenges.

* **Runtime Manipulation:** The application relies entirely on local checks within the Java code to protect sensitive functions (`get_flag`).
* **Lack of RASP:** There were no mechanisms detected for Root or Anti-Tamper/Hooking detection, allowing Frida scripts to run unimpeded.

> [!summary] Key Recommendation
> Sensitive logic validation should be moved to a secure server-side environment. If client-side checks are unavoidable, the application should implement code obfuscation (e.g., ProGuard/R8) and Runtime Application Self-Protection (RASP) to detect and block instrumentation tools like Frida.

---

## 2. Attack Walkthrough

> [!info] Attack Narratives
> This section outlines the methodologies used to bypass logic controls in both challenges.

### Challenge 0x6: Field Manipulation
1.  **Static Analysis:** Decompilation revealed a `Checker` class with two public integer fields (`num1`, `num2`). The `get_flag` method validates that `num1 == 1234` and `num2 == 4321`.
2.  **Instrumentation:** A Frida script was developed to hook the `MainActivity.onCreate` method.
3.  **Exploitation:** The script instantiated the `Checker` class, manually assigned the required integer values to the fields, and invoked the `get_flag` method, resulting in the flag being displayed.

### Challenge 0x7: Constructor Injection
1.  **Static Analysis:** Similar to the previous challenge, logic validation occurred within `get_flag`. However, the `Checker` class utilized a constructor to initialize its values.
2.  **Instrumentation:** The Frida script was adapted to hook `onCreate`.
3.  **Exploitation:** The script instantiated the `Checker` object via its constructor (`$new(600, 600)`), passing the specific integer arguments required to satisfy the internal logic. The instance was then passed to `get_flag`, revealing the secret.

---

## 3. Findings Summary

### 3.1 Severity Breakdown

| Severity | Count |
| :--- | :---: |
| ðŸ”´ **High** | 2 |
| ðŸŸ  **Medium** | 0 |
| ðŸŸ¡ **Low** | 0 |
| âšª **Info** | 0 |
| **Total** | **2** |

### 3.2 Finding List

| ID | Severity | Finding Name |
| :--- | :--- | :--- |
| [[#4.1 Insecure Client-Side Logic (Field Manipulation)\|1]] | ðŸ”´ High | Insecure Client-Side Logic (Field Manipulation) |
| [[#4.2 Insecure Client-Side Logic (Constructor Injection)\|2]] | ðŸ”´ High | Insecure Client-Side Logic (Constructor Injection) |

---

## 4. Technical Findings Details

### 4.1 Insecure Client-Side Logic (Field Manipulation)

> [!fail] Severity: High
> **CVSS Score:** 7.5
> **CWE:** [CWE-602: Client-Side Enforcement of Server-Side Security](https://cwe.mitre.org/data/definitions/602.html)

#### Description
The application (Challenge 0x6) contains a hidden method `get_flag` that is guarded only by a simple integer comparison logic (`num1` and `num2`). These variables are defined in the `Checker` class. The application fails to validate the integrity of these objects at runtime, allowing an attacker to instantiate the class and modify the fields arbitrarily.

#### Security Impact
An attacker can bypass intended business logic or unlock premium/hidden features without authorization. In this context, it allowed for the retrieval of the hidden flag.

#### Evidence
**1. Initial State:**
The application presents a default screen.
![[Pasted image 20251219225938.png]]

**2. Static Analysis (Jadx):**
The code logic requires `num1=1234` and `num2=4321`.
![[Pasted image 20251219230055.png]]
![[Pasted image 20251219230305.png]]

**3. Frida Exploitation:**
The following script was used to instantiate the object, set values directly, and invoke the target function:

```javascript
Java.perform(function () {
    var MainActivity = Java.use("com.ad2001.frida0x6.MainActivity");
    var Check = Java.use("com.ad2001.frida0x6.Checker");
    var obj = Check.$new();
    
    // Manually setting fields to satisfy logic
    obj.num1.value = 1234;
    obj.num2.value = 4321;

    MainActivity.onCreate.overload('android.os.Bundle').implementation = function (bundle) {
        this.onCreate(bundle); 
        console.log("[+] onCreate hooked");
        this.get_flag(obj);
    };
});
```

**4. Result:**
The flag was successfully retrieved.
![[Pasted image 20251219232659.png]]

#### Remediation
* [ ] **Server-Side Validation:** Move critical logic checks to a trusted server environment.
* [ ] **Field Encapsulation:** Make class fields `private` (though still bypassable via reflection/Frida, it adds a layer of friction).
* [ ] **Root/Hook Detection:** Implement checks to detect Frida or Xposed frameworks.

---

### 4.2 Insecure Client-Side Logic (Constructor Injection)

> [!fail] Severity: High
> **CVSS Score:** 7.5
> **CWE:** [CWE-602](https://cwe.mitre.org/data/definitions/602.html)

#### Description
In Challenge 0x7, the application attempts to secure the `get_flag` method by requiring a `Checker` object initialized via a specific constructor. However, the logic remains entirely client-side. An attacker can use dynamic instrumentation to locate the correct constructor signature and instantiate the object with the required parameters to bypass the check.

#### Security Impact
Similar to the previous finding, this allows for the unauthorized execution of restricted methods by manipulating object creation at runtime.

#### Evidence
**1. Static Analysis (Jadx):**
Analysis revealed the constructor requirement for the `Checker` class.
![[Pasted image 20251219233052.png]]
![[Pasted image 20251219233142.png]]

**2. Frida Exploitation:**
The script was modified to use the constructor (`$new(int, int)`) to satisfy the condition:

```javascript
Java.perform(function () {
    var MainActivity = Java.use("com.ad2001.frida0x7.MainActivity");
    var Check = Java.use("com.ad2001.frida0x7.Checker");

    MainActivity.onCreate.overload('android.os.Bundle').implementation = function (bundle) {
        this.onCreate(bundle);
        console.log("[+] onCreate hooked");
        
        // Instantiating via constructor with required values
        var obj = Check.$new(600,600);
        this.get_flag(obj);
    };
});
```

**3. Result:**
The flag was successfully retrieved.
![[Pasted image 20251219234420.png]]

#### Remediation
* [ ] **Code Obfuscation:** Use tools like R8/ProGuard to rename classes and methods, making reverse engineering significantly harder.
* [ ] **Native Code (JNI):** Move sensitive logic into C/C++ native libraries (`.so` files), which are harder to reverse engineer and hook than Java code.

---

## 5. Remediation Summary

### Short Term
* [ ] **Obfuscation:** Enable R8 shrinking and obfuscation in the `build.gradle` release configuration.
* [ ] **Signature Checks:** Validate the integrity of the APK at runtime to ensure it hasn't been tampered with or repackaged.

### Long Term
* [ ] **Architecture Redesign:** Migrate sensitive "flag" generation or business logic to a backend API. The mobile app should only display data received from the server after successful authentication.
* [ ] **RASP Implementation:** Integrate a commercial or open-source Runtime Application Self-Protection solution to detect and crash the app when hooking tools are present.