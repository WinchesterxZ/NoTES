---
tags:
  - report
  - pentest
  - mobile
  - diva
date: 2025-12-12
client: Diva Mobile App
author: Ahmed Emad
version: 1.0
status: Draft
---

# Penetration Test Report
**Client:** [[Diva Mobile App]]
**Date:** 2025-12-12
**Assessment Type:** Mobile Application Penetration Test

---

## ðŸ”’ Statement of Confidentiality

> [!danger] CONFIDENTIAL
> The contents of this document have been developed by **[Your Company Name]**. We consider the contents of this document to be proprietary and business confidential information. This document may not be released to another vendor, business partner, or contractor without prior written consent.
>
> The contents of this document do not constitute legal advice.

---

## 1. Engagement Contacts

| Role          | Name       | Title               | Email            |
| :------------ | :--------- | :------------------ | :--------------- |
| **Pentester** | Ahmed Emad | Security Consultant | testmail@lol.com |

---

## 2. Executive Summary

**Diva Mobile App** contracted **[Fake Compony]** to perform a Mobile Application Penetration Test. The goal of this assessment was to identify security weaknesses in the Android application, specifically focusing on insecure data storage and local vulnerabilities.

### 2.1 Scope
The scope of this assessment included the following assets:

| Asset | Description |
| :--- | :--- |
| `Diva.apk` | Android Application Package |
| `Insecure Data Storage Part 4` | Specific Activity Tested |

### 2.2 Assessment Overview
During the assessment, we identified a **High** severity vulnerability regarding the storage of sensitive user credentials.

* **Insecure Data Storage:** The application was found to save user credentials in plaintext on the device's external storage (SD card), making them accessible to other applications and users.

> [!summary] Key Recommendation
> The organization must immediate cease the practice of storing credentials in external storage. Sensitive data should be stored within the application's private internal directory, preferably using the Android Keystore system or `EncryptedSharedPreferences`.

---

## 3. Attack Walkthrough

> [!info] Attack Chain Narrative
> This section details the steps taken to recover cleartext credentials from the device storage.

1.  **Functionality Testing:** The assessor interacted with the "Insecure Data Storage Part 4" activity, submitting test credentials. A toast message confirmed the data was saved.
2.  **Static Analysis:** The application source code was reverse-engineered using `jadx-gui`. Analysis revealed the application logic writes the username and password to a file named `.uinfo.txt` on the external storage (`sdirpath`) without encryption.
3.  **Data Exfiltration:** Using the Android Debug Bridge (`adb`), the assessor accessed the device shell, navigated to the SD card, and read the contents of `.uinfo.txt`, successfully retrieving the plaintext credentials.

---

## 4. Findings Summary

### 4.1 Severity Breakdown

| Severity | Count |
| :--- | :---: |
| ðŸ”´ **High** | 1 |
| ðŸŸ  **Medium** | 0 |
| ðŸŸ¡ **Low** | 0 |
| âšª **Info** | 0 |
| **Total** | **1** |

### 4.2 Finding List

| ID | Severity | Finding Name |
| :--- | :--- | :--- |
| [[#5.1 Insecure Data Storage in External Storage (Plaintext)\|1]] | ðŸ”´ High | Insecure Data Storage in External Storage (Plaintext) |

---

## 5. Technical Findings Details

### 5.1 Insecure Data Storage in External Storage (Plaintext)

> [!fail] Severity: High
> **CVSS Score:** 7.6 (High)
> **CWE:** [CWE-312: Cleartext Storage of Sensitive Information](https://cwe.mitre.org/data/definitions/312.html) / [CWE-922](https://cwe.mitre.org/data/definitions/922.html)

#### Description
The application stores sensitive user authentication credentials (username and password) in an unencrypted text file located on the device's external storage (SD Card).

Static analysis using `jadx-gui` confirmed that the application takes user input and writes it directly to `sdirpath/uinfo.txt` without applying any hashing or encryption algorithms. Unlike internal storage, external storage is world-readable (or readable by any app with `READ_EXTERNAL_STORAGE` permission on older Android versions) and accessible via physical connection to a computer.

#### Security Impact
Storing credentials in plaintext on external storage exposes the user to immediate account takeover.
* **Malicious Apps:** Any malicious application installed on the user's device with storage permissions can harvest these credentials.
* **Physical Access:** If a device is lost or stolen, or connected to a PC via USB, the credentials can be trivially extracted without root access.

#### Evidence
**Affected Component:**
* `Insecure Data Storage Part 4` Activity

**1. Application Confirmation:**
Upon entering credentials, the application confirms storage via a toast message.
![[Pasted image 20251212001449.png]]
*Figure 1: Application saving 3rd party credentials.*

**2. Static Code Analysis:**
Reverse engineering via `jadx-gui` shows the insecure file write operation:
![[Pasted image 20251212001728.png]]
*Figure 2: Source code revealing the path and lack of encryption.*

**3. Exploitation via ADB:**
The assessor utilized `adb shell` to locate and read the file:

```bash
adb shell
cd sdcard
ls -la .uinfo.txt
# Output: -rw-rw---- 1 u0_a47 media_rw 9 2025-12-12 00:14 .uinfo.txt

cat .uinfo.txt
```

**Result:**
The file contained the plaintext credentials previously submitted.
![[Pasted image 20251212002143.png]]
*Figure 3: Retrieving plaintext credentials from the SD card.*

#### Remediation
* [ ] **Stop using External Storage:** Sensitive data should never be stored on external media (SD card). Store data in the application's private internal storage directory (`/data/data/<package_name>/`).
* [ ] **Implement Encryption:** If local storage of credentials is required, use `EncryptedSharedPreferences` (part of Jetpack Security) or the Android Keystore system to encrypt the data at rest.
* [ ] **Tokenization:** Ideally, store a short-lived session token rather than the actual username and password.

**References:**
* [Android Developer Guide: Data and File Storage](https://developer.android.com/training/data-storage)
* [OWASP Mobile Top 10: M1 - Insecure Data Storage](https://owasp.org/www-project-mobile-top-10/2016-risks/m1-insecure-data-storage)

---

## 6. Remediation Summary

### Short Term (Immediate)
* [ ] **[Finding 1]**: Immediately release a patch that moves credential storage to internal private storage and implements encryption.
* [ ] Force a password reset for users, as existing stored credentials may have been compromised.

### Long Term
* [ ] Implement a Secure SDLC (Software Development Life Cycle) to catch insecure storage issues during the development phase.
* [ ] Conduct regular static and dynamic analysis (SAST/DAST) on the mobile application.

---

## 7. Appendices

### Appendix A: Severity Definitions

| Rating | Definition |
| :--- | :--- |
| **High** | Exploitation causes substantial harm. Significant political, financial, or legal damage is likely. |
| **Medium** | Exploitation impacts confidentiality, integrity, or availability. Moderate financial loss. |
| **Low** | Minimal impact. Operations are slightly affected. |