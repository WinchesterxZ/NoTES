# TryHackMe: Steel Mountain Walkthrough

![[Pasted image 20260103031520.png]]

**Room Description:** Enumerate a Windows machine, gain initial access with Metasploit, use PowerShell to further enumerate the machine, and escalate your privileges to Administrator.

---

## 1. Introduction

**Objective:** Deploy the machine and identify the employee of the month.

I accessed the website at `http://10.82.176.190/`.
![[Pasted image 20260102035440.png]]

I checked the page source to find the filename of the image.
![[Pasted image 20260102035510.png]]

### Question 1
**Who is the employee of the month?**
> **Answer:** `Bill Harper`

---

## 2. Initial Access

### Enumeration
I started by scanning the machine to identify open ports.

![[Pasted image 20260102041206.png]]

### Question 2
**Scan the machine with nmap. What is the other port running a web server on?**
> **Answer:** `8080`

---

### File Server Analysis
I visited the service running on port 8080.

![[Pasted image 20260102042254.png]]

### Question 3
**Take a look at the other web server. What file server is running?**
> **Answer:** `Rejetto Http File Server`

---

### Exploit Research
I searched for vulnerabilities related to Rejetto HFS version 2.3 using `searchsploit`.

![[Pasted image 20260102042856.png]]

### Question 4
**What is the CVE number to exploit this file server?**
> **Answer:** `2014-6287`

---

### Exploitation
Instead of using Metasploit, I performed a manual exploitation:
1.  Downloaded the Python exploit script.
2.  Modified it with my local IP and port.
3.  Set up a Python HTTP server to host `nc.exe`.
4.  Set up a Netcat listener on port `1234`.

![[Pasted image 20260102060027.png]]

The exploit triggered the download of `nc.exe` and executed the reverse shell.

![[Pasted image 20260102060101.png]]

I successfully gained access.

![[Pasted image 20260102060332.png]]

### Question 5
**Use Metasploit to get an initial shell. What is the user flag?**
> **Answer:** `b04763b6fcf51fcd7c13abc7db4fd365`

---

## 3. Privilege Escalation

### Enumeration
To identify escalation vectors, I uploaded **PowerUp.ps1** to the target and ran `Invoke-AllChecks`.

![[Pasted image 20260102061136.png]]
![[Pasted image 20260102061447.png]]

The script identified a service with the `CanRestart` option set to true and an unquoted path.

### Question 6
**Take close attention to the CanRestart option that is set to true. What is the name of the service which shows up as an _unquoted service path_ vulnerability?**
> **Answer:** `AdvancedSystemCareService9`

---

### Exploitation (Unquoted Service Path)
I checked the permissions for the service folder.

![[Pasted image 20260102065358.png]]

Since I had write access, I generated a malicious executable named `Advanced.exe` using `msfvenom`.

![[Pasted image 20260102065849.png]]

I transferred the file to the target machine.

![[Pasted image 20260102065924.png]]

I stopped and restarted the service to trigger the malicious binary.

![[Pasted image 20260102070148.png]]

The listener caught the connection, granting Administrator access.

![[Pasted image 20260102070343.png]]

### Question 7
**What is the root flag?**
> **Answer:** `9af5f314f57607c00fd09803a587db80`

### Question 8
**What powershell -c command could we run to manually find out the service name?**
> **Answer:** `powershell -c get-service`