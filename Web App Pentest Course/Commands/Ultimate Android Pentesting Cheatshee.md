# **Ultimate Android Pentesting Cheatsheet**

## **1. Essential Commands & Tool Reference**

### **ADB (Android Debug Bridge) Commands**

#### **Core Commands**
**List connected devices and their status**
```bash
adb devices
```
**Connect to a device via Wi-Fi**
```bash
adb connect <ip_address>
```
**Restart adbd with root privileges (requires rootable/production build)**
```bash
adb root
```
**Restart ADB to listen on TCP port 5555 for Wi-Fi connection**
```bash
adb tcpip 5555
```
**Kill the ADB server instance (useful for connection issues)**
```bash
adb kill-server
```

#### **Application Management**
**Install or reinstall (update) an app**
```bash
adb install -r <apk_file>
```
**Remove an application**
```bash
adb uninstall <package_name>
```
**List all installed packages**
```bash
adb shell pm list packages
```
**Get the path to the APK file on the device**
```bash
adb shell pm path <package_name>
```
**Pull installed APK**
```shell
adb pull /data/app/~~mx-u5XjocnQsLuyKssPYww==/com.indeed.android.jobsearch-Yws1u7nJeRkLALv4qF3JWw==/base.apk indeed.apk
```
**Delete all data associated with a package**
```bash
adb shell pm clear <package_name>
```
**List only third party packages**
```bash
adb shell pm list packages -3
```
#### **Shell & Device Interaction**
**Start a remote shell on the device**
```bash
adb shell
```
**Copy files from computer to device**
```bash
adb push <local> <remote>
```
**Copy files from device to computer**
```bash
adb pull <remote> <local>
```
**View the system log buffers**
```bash
adb logcat
```
**Take a screenshot**
```bash
adb shell screencap -p /sdcard/img.png
```
**Record the screen**
```bash
adb shell screenrecord /sdcard/video.mp4
```

### **Android Component Interaction (ADB/am/pm)**

#### **Launching Components**
**Start Activity**
```bash
adb shell am start -n <package_name>/<activity_name>
```
**Start Activity with String Extra**
```bash
adb shell am start -n <pkg>/<act> -es "key" "value"
```
**Start Activity with Action and Boolean Extra**
```bash
adb shell am start -a <pkg>/<act> -ez key value
```
**Start Activity with Action**
```shell
adb shell am start -a jakhar.aseem.diva.action.VIEW_CREDS
```
**Start Service**
```bash
adb shell am startservice -n <package_name>/<service_name>
```
**Send Broadcast**
```bash
adb shell am broadcast -a <action_name>
```
**Get current screen in code**
```bash
adb shell dumpsys window | grep -i mCurrentFocus
```
#### **Permissions Management**
**List permissions organized by group**
```bash
adb shell pm list permissions -g
```
**Reset all permissions for an app**
```bash
adb shell pm reset-permissions -p <package_name>
```
**List information such as activities and permissions of a package.**
```bash
adb shell dumpsys package <package_name>
```


### **Inspecting Filesystems**

#### **Navigation Commands**
**List files recursively**
```bash
adb shell ls -R /
```
**Search for files by name**
```bash
adb shell find / -name "*<search_term>*"
```
**List mounted file systems**
```bash
adb shell mount
```

#### **Common Sensitive Directories**
**Shared Preferences**
```text
/data/data/<package_name>/shared_prefs/
```
**Databases**
```text
/data/data/<package_name>/databases/
```
**Cache**
```text
/data/data/<package_name>/cache/
```
**External Storage**
```text
/sdcard/
```

### **Frida & Objection**

#### **Frida Setup**
**Push Server**
```bash
adb push frida-server /data/local/tmp/
```
**Set Permissions**
```bash
adb shell "chmod 755 /data/local/tmp/frida-server"
```
**Run Server**
```bash
adb shell "/data/local/tmp/frida-server &"
```

#### **Frida Process Interaction**
**List running processes on USB device**
```bash
frida-ps -U
```
**Attach to a running process**
```bash
frida -U <process_name>
```
**Spawn a new process and attach immediately**
```bash
frida -U -f <package_name> --no-pause
```

#### **Objection Automation**
**Start Objection REPL**
```bash
objection -g <package_name> explore
```
**SSL Pinning Bypass**
```bash
android sslpinning disable
```
**Root Detection Bypass**
```bash
android root disable
```
**Search for classes to hook**
```bash
android hooking search classes <name>
```

### **APK/Code Static Analysis**

#### **Decompilation & Reassembly**
**Decode APK (Resources and Smali)**
```bash
apktool d <apk_file>
```
**Build APK from modified source**
```bash
apktool b <folder_name>
```
**Decode without Resources (if standard decode fails)**
```bash
apktool d -r <apk_file>
```

#### **Code Conversion**
**Convert DEX to JAR**
```bash
d2j-dex2jar.sh <apk_file>
```
**View Java source code (Jadx)**
```bash
jadx-gui <apk_file>
```

### **Proxying & Network Interception**

#### **Device Setup**
**ADB Reverse (Host Proxy -> Device)**
```bash
adb reverse tcp:8080 tcp:8080
```
**Push CA Certificate to Device**
```bash
adb push cert.cer /sdcard/
```

---

## **2. Vulnerability Hunting Techniques & Methodology**

### **Initial Setup & Environment**
**Objection: Disable Root Detection**
```bash
android root disable
```

### **Client-Side Storage / Data Exposure**
**Search for XML files**
```bash
adb shell ls /data/data/<package>/shared_prefs/*.xml
```
**Inspect Databases (sqlite3)**
```bash
sqlite3 /data/data/<package>/databases/my_db.db
```

### **Component Exposure**
**Bypass Auth / Launch Activity Directly**
```bash
adb shell am start -n <package_name>/<activity_name>
```
**Query Content Provider**
```bash
adb shell content query --uri <uri>
```
**Test SQL Injection in Content Provider**
```bash
adb shell content query --uri <uri> --projection "' OR 1=1 --"
```

### **Hardcoded Secrets & API Key Analysis**
**Grep for secrets in source**
```bash
grep -rE "password|api_key|access_token|secret" .
```

### **Network Security**
**Objection: Disable SSL Pinning**
```bash
android sslpinning disable
```

### **Input Validation & WebViews**
**Fuzz Deep Links**
```bash
adb shell am start -d "scheme://payload"
```